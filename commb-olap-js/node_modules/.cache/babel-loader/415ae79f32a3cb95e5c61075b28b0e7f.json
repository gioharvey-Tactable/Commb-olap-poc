{"ast":null,"code":"import { Dialog } from '@syncfusion/ej2-popups';\nimport { createElement, setStyleAttribute, remove, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\nimport * as cls from '../../common/base/css-constant';\nimport { Grid, Reorder, Resize, ColumnChooser, Toolbar, ExcelExport, PdfExport } from '@syncfusion/ej2-grids';\nimport { VirtualScroll, Selection, Edit, Page, CommandColumn } from '@syncfusion/ej2-grids';\nimport * as events from '../../common/base/constant';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * `DrillThroughDialog` module to create drill-through dialog.\n */\n\n/** @hidden */\n\nvar DrillThroughDialog = function () {\n  /* eslint-disable-next-line */\n\n  /**\n   * Constructor for the dialog action.\n   * @hidden\n   */\n  function DrillThroughDialog(parent) {\n    /** @hidden */\n    this.indexString = [];\n    this.clonedData = [];\n    this.isUpdated = false;\n    this.gridIndexObjects = {};\n    this.gridData = [];\n    this.formatList = {};\n    this.parent = parent;\n    this.engine = this.parent.dataType === 'olap' ? this.parent.olapEngineModule : this.parent.engineModule;\n  }\n\n  DrillThroughDialog.prototype.frameHeaderWithKeys = function (header) {\n    var keys = Object.keys(header);\n    var keyPos = 0;\n    var framedHeader = {};\n    /* eslint-disable-line */\n\n    while (keyPos < keys.length) {\n      framedHeader[keys[keyPos]] = header[keys[keyPos]];\n      keyPos++;\n    }\n\n    return framedHeader;\n  };\n  /* eslint-disable-next-line */\n\n  /** @hidden */\n\n\n  DrillThroughDialog.prototype.showDrillThroughDialog = function (eventArgs) {\n    var _this = this;\n\n    this.gridData = eventArgs.rawData;\n\n    for (var i = 0; i < eventArgs.rawData.length; i++) {\n      this.clonedData.push(this.frameHeaderWithKeys(eventArgs.rawData[i]));\n    }\n\n    var actualText = eventArgs.currentCell.actualText.toString();\n\n    if (this.engine.fieldList[actualText].aggregateType !== 'Count' && this.parent.editSettings.allowInlineEditing && this.parent.editSettings.allowEditing && eventArgs.rawData.length === 1 && this.engine.fieldList[actualText].aggregateType !== 'DistinctCount' && typeof eventArgs.rawData[0][actualText] !== 'string') {\n      this.editCell(eventArgs);\n    } else {\n      this.removeDrillThroughDialog();\n      var drillThroughDialog = createElement('div', {\n        id: this.parent.element.id + '_drillthrough',\n        className: cls.DRILLTHROUGH_DIALOG\n      });\n      this.parent.element.appendChild(drillThroughDialog);\n      this.dialogPopUp = new Dialog({\n        animationSettings: {\n          effect: 'Fade'\n        },\n        allowDragging: false,\n        header: this.parent.localeObj.getConstant('details'),\n        content: this.createDrillThroughGrid(eventArgs),\n        beforeOpen: function () {\n          _this.drillThroughGrid.setProperties({\n            dataSource: _this.parent.editSettings.allowEditing ? _this.dataWithPrimarykey(eventArgs) : _this.gridData,\n            height: !_this.parent.editSettings.allowEditing ? 300 : 220\n          }, false);\n        },\n        beforeClose: function () {\n          if (_this.parent.editSettings.allowEditing && _this.isUpdated) {\n            if (_this.parent.dataSourceSettings.type === 'CSV') {\n              _this.updateData(_this.drillThroughGrid.dataSource);\n            }\n\n            var gridIndexObjectsValue = Object.keys(_this.gridIndexObjects);\n            var previousPosition = [];\n\n            for (var _i = 0, gridIndexObjectsValue_1 = gridIndexObjectsValue; _i < gridIndexObjectsValue_1.length; _i++) {\n              var value = gridIndexObjectsValue_1[_i];\n              previousPosition.push(_this.gridIndexObjects[value]);\n            }\n\n            var count = Object.keys(_this.gridIndexObjects).length;\n            var addItems = [];\n            var prevItems = [];\n            var index = 0;\n            /* eslint-disable @typescript-eslint/dot-notation */\n\n            for (var _a = 0, _b = _this.drillThroughGrid.dataSource; _a < _b.length; _a++) {\n              var item = _b[_a];\n\n              if (isNullOrUndefined(item['__index']) || item['__index'] === '') {\n                for (var _c = 0, _d = _this.engine.fields; _c < _d.length; _c++) {\n                  var field = _d[_c];\n\n                  if (isNullOrUndefined(item[field])) {\n                    delete item[field];\n                  }\n                }\n\n                delete item['__index'];\n                addItems.push(item);\n              } else if (count > 0) {\n                if (isBlazor() && _this.parent.editSettings.allowCommandColumns) {\n                  _this.parent.engineModule.data[Number(item['__index'])] = item;\n                }\n\n                delete _this.gridIndexObjects[item['__index'].toString()];\n                prevItems.push(item);\n                count--;\n              }\n\n              if (_this.parent.dataSourceSettings.mode === 'Server') {\n                if (item['__index']) {\n                  delete item['__index'];\n                }\n\n                if (_this.gridData[index]['__index']) {\n                  delete _this.gridData[index]['__index'];\n                }\n              }\n\n              index++;\n            }\n\n            count = 0;\n\n            if (isBlazor() && _this.parent.enableVirtualization) {\n              var currModule_1 = _this;\n              /* eslint-disable-line */\n\n              /* eslint-disable @typescript-eslint/no-explicit-any */\n\n              currModule_1.parent.interopAdaptor.invokeMethodAsync('PivotInteropMethod', 'updateRawData', {\n                'AddItem': addItems,\n                'RemoveItem': currModule_1.gridIndexObjects,\n                'ModifiedItem': currModule_1.gridData\n                /* eslint-disable-line */\n\n              }).then(function (data) {\n                currModule_1.parent.updateBlazorData(data, currModule_1.parent);\n                currModule_1.parent.allowServerDataBinding = false;\n                currModule_1.parent.setProperties({\n                  pivotValues: currModule_1.parent.engineModule.pivotValues\n                }, true);\n                delete currModule_1.parent.bulkChanges.pivotValues;\n                currModule_1.parent.allowServerDataBinding = true;\n                currModule_1.isUpdated = false;\n                currModule_1.gridIndexObjects = {};\n              });\n              /* eslint-enable @typescript-eslint/no-explicit-any */\n            } else if (_this.parent.dataSourceSettings.mode === 'Server') {\n              var gridIndex = [];\n              /* eslint-disable-line */\n\n              var keys = Object.keys(_this.gridIndexObjects);\n\n              for (var len = 0; len < keys.length; len++) {\n                delete _this.parent.drillThroughValue.indexObject[_this.gridIndexObjects[keys[len]]];\n                gridIndex.push({\n                  Key: keys[len],\n                  Value: _this.gridIndexObjects[keys[len]]\n                });\n                /* eslint-disable-line */\n              }\n\n              var indexObject = [];\n              /* eslint-disable-line */\n\n              keys = Object.keys(_this.parent.drillThroughValue.indexObject);\n\n              for (var len = 0; len < keys.length; len++) {\n                indexObject.push({\n                  Key: keys[len],\n                  Value: _this.parent.drillThroughValue.indexObject[keys[len]]\n                });\n                /* eslint-disable-line */\n              }\n\n              _this.parent.getEngine('updateRawData', null, null, null, null, null, null, null, {\n                'addedData': addItems,\n                'removedData': gridIndex,\n                'updatedData': prevItems,\n                indexObject: indexObject\n              });\n            } else {\n              var items = [];\n              var data = _this.parent.allowDataCompression && _this.parent.enableVirtualization ? _this.parent.engineModule.actualData : _this.parent.engineModule.data;\n\n              for (var _e = 0, _f = data; _e < _f.length; _e++) {\n                var item = _f[_e];\n                delete item['__index'];\n\n                if (_this.gridIndexObjects[count.toString()] === undefined) {\n                  items.push(item);\n                }\n\n                count++;\n              }\n              /* eslint-enable @typescript-eslint/dot-notation */\n\n\n              items = items.concat(addItems);\n              var eventArgs_1 = {\n                currentData: _this.drillThroughGrid.dataSource,\n                previousData: _this.clonedData,\n                previousPosition: previousPosition,\n                cancel: false\n              };\n\n              _this.parent.trigger(events.editCompleted, eventArgs_1);\n\n              if (!eventArgs_1.cancel) {\n                _this.parent.setProperties({\n                  dataSourceSettings: {\n                    dataSource: items\n                  }\n                }, true);\n\n                _this.engine.updateGridData(_this.parent.dataSourceSettings);\n\n                _this.parent.pivotValues = _this.engine.pivotValues;\n              }\n            }\n          }\n\n          if (!(isBlazor() && _this.parent.enableVirtualization)) {\n            _this.isUpdated = false;\n            _this.gridIndexObjects = {};\n          }\n        },\n        isModal: true,\n        visible: true,\n        showCloseIcon: true,\n        locale: this.parent.locale,\n        enableRtl: this.parent.enableRtl,\n        width: this.parent.isAdaptive ? '100%' : '60%',\n        position: {\n          X: 'center',\n          Y: 'center'\n        },\n        closeOnEscape: true,\n        target: document.body,\n        close: this.removeDrillThroughDialog.bind(this)\n      });\n      this.dialogPopUp.isStringTemplate = true;\n      this.dialogPopUp.appendTo(drillThroughDialog); // this.dialogPopUp.element.querySelector('.e-dlg-header').innerHTML = this.parent.localeObj.getConstant('details');\n\n      setStyleAttribute(this.dialogPopUp.element, {\n        'visibility': 'visible'\n      });\n    }\n  };\n\n  DrillThroughDialog.prototype.editCell = function (eventArgs) {\n    var _this = this;\n\n    var gridResize = this.parent.gridSettings.allowResizing;\n    var actualText = eventArgs.currentCell.actualText.toString();\n    var indexObject = Number(Object.keys(eventArgs.currentCell.indexObject));\n    eventArgs.currentTarget.firstElementChild.style.display = 'none';\n    var cellValue = Number(eventArgs.rawData[0][actualText]);\n    /* eslint-disable */\n\n    var previousData = this.frameHeaderWithKeys(eventArgs.rawData[eventArgs.rawData.length - 1]);\n    var currentData = eventArgs.rawData[eventArgs.rawData.length - 1];\n    /* eslint-enable */\n\n    if (eventArgs.currentCell.actualText in previousData) {\n      currentData[eventArgs.currentCell.actualText] = eventArgs.currentCell.actualValue;\n    }\n\n    this.numericTextBox = new NumericTextBox({\n      value: cellValue,\n      enableRtl: this.parent.enableRtl,\n      enabled: true,\n      format: '####.##',\n      locale: this.parent.locale,\n      change: function () {\n        var textBoxValue = _this.numericTextBox.value;\n        var indexValue = eventArgs.currentCell.indexObject[indexObject];\n        eventArgs.rawData[0][actualText] = textBoxValue;\n        _this.parent.engineModule.data[indexValue] = eventArgs.rawData[0];\n      },\n      blur: function () {\n        var eventArgs = {\n          currentData: currentData,\n          previousData: previousData,\n          previousPosition: currentData.index,\n          cancel: false\n        };\n\n        _this.parent.trigger(events.editCompleted, eventArgs);\n\n        if (!eventArgs.cancel) {\n          _this.parent.setProperties({\n            dataSourceSettings: {\n              dataSource: _this.parent.engineModule.data\n            }\n          }, true);\n\n          _this.engine.updateGridData(_this.parent.dataSourceSettings);\n\n          _this.parent.pivotValues = _this.engine.pivotValues;\n          _this.parent.gridSettings.allowResizing = gridResize;\n        }\n      }\n    });\n    var textBoxElement = createElement('input', {\n      id: this.parent.element.id + '_inputbox'\n    });\n    eventArgs.currentTarget.appendChild(textBoxElement);\n    this.numericTextBox.appendTo(textBoxElement);\n    eventArgs.currentCell.value = this.numericTextBox.value;\n    this.numericTextBox.focusIn();\n    this.parent.gridSettings.allowResizing = false;\n  };\n  /* eslint-disable , @typescript-eslint/no-explicit-any */\n\n\n  DrillThroughDialog.prototype.updateData = function (dataSource) {\n    var dataPos = 0;\n    var data = this.parent.allowDataCompression && this.parent.enableVirtualization ? this.parent.engineModule.actualData : this.parent.engineModule.data;\n\n    while (dataPos < dataSource.length) {\n      var fields = Object.keys(dataSource[dataPos]);\n      var keyPos = 0;\n      var framedSet = [];\n\n      while (keyPos < fields.length) {\n        if (!isNullOrUndefined(this.parent.engineModule.fieldKeys[fields[keyPos]])) {\n          framedSet[this.parent.engineModule.fieldKeys[fields[keyPos]]] = dataSource[dataPos][fields[keyPos]];\n        }\n\n        keyPos++;\n      }\n\n      data[dataSource[dataPos]['__index']] = framedSet;\n      /* eslint-disable-line */\n\n      dataPos++;\n    }\n\n    if (this.parent.allowDataCompression && this.parent.enableVirtualization) {\n      this.parent.engineModule.actualData = data;\n    } else {\n      this.parent.engineModule.data = data;\n    }\n  };\n\n  DrillThroughDialog.prototype.removeDrillThroughDialog = function () {\n    if (this.dialogPopUp && !this.dialogPopUp.isDestroyed) {\n      this.dialogPopUp.destroy();\n    }\n\n    var dialogElement = document.getElementById(this.parent.element.id + '_drillthrough');\n\n    if (dialogElement) {\n      remove(dialogElement);\n    }\n\n    if (document.getElementById(this.parent.element.id + '_drillthroughgrid_ccdlg')) {\n      remove(document.getElementById(this.parent.element.id + '_drillthroughgrid_ccdlg'));\n    }\n  };\n  /* eslint-disable  */\n\n\n  DrillThroughDialog.prototype.createDrillThroughGrid = function (eventArgs) {\n    var drillThroughBody = createElement('div', {\n      id: this.parent.element.id + '_drillthroughbody',\n      className: cls.DRILLTHROUGH_BODY_CLASS\n    });\n    var drillThroughBodyHeader = createElement('div', {\n      id: this.parent.element.id + '_drillthroughbodyheader',\n      className: cls.DRILLTHROUGH_BODY_HEADER_CONTAINER_CLASS\n    });\n\n    if (eventArgs.rowHeaders !== '') {\n      drillThroughBodyHeader.innerHTML = '<span class=' + cls.DRILLTHROUGH_BODY_HEADER_COMMON_CLASS + '><span class=' + cls.DRILLTHROUGH_BODY_HEADER_CLASS + '>' + this.parent.localeObj.getConstant('row') + '</span> :<span class=' + cls.DRILLTHROUGH_BODY_HEADER_VALUE_CLASS + '>' + eventArgs.rowHeaders + '</span></span>';\n    }\n\n    if (eventArgs.columnHeaders !== '') {\n      drillThroughBodyHeader.innerHTML = drillThroughBodyHeader.innerHTML + '<span class=' + cls.DRILLTHROUGH_BODY_HEADER_COMMON_CLASS + '><span class=' + cls.DRILLTHROUGH_BODY_HEADER_CLASS + '>' + this.parent.localeObj.getConstant('column') + '</span> :<span class=' + cls.DRILLTHROUGH_BODY_HEADER_VALUE_CLASS + '>' + eventArgs.columnHeaders + '</span></span>';\n    }\n\n    if (eventArgs.value !== '') {\n      var measure = eventArgs.value.split('(')[0];\n      var value = eventArgs.value.split('(')[1].split(')')[0];\n\n      if (value !== '0') {\n        drillThroughBodyHeader.innerHTML = drillThroughBodyHeader.innerHTML + '<span class=' + cls.DRILLTHROUGH_BODY_HEADER_COMMON_CLASS + '><span class=' + cls.DRILLTHROUGH_BODY_HEADER_CLASS + '>' + measure + '</span> :<span class=' + cls.DRILLTHROUGH_BODY_HEADER_VALUE_CLASS + '>' + value + '</span></span>';\n      }\n    }\n\n    var toolbarItems = ['ColumnChooser'];\n\n    if (this.parent.editSettings.allowEditing) {\n      if (this.parent.editSettings.allowCommandColumns) {\n        toolbarItems = ['ColumnChooser', 'Add'];\n      } else if (this.parent.editSettings.mode === 'Batch') {\n        toolbarItems = ['ColumnChooser', 'Add', 'Delete', 'Update', 'Cancel'];\n      } else if (this.parent.editSettings.mode === 'Dialog') {\n        toolbarItems = ['ColumnChooser', 'Add', 'Edit', 'Delete'];\n      } else {\n        toolbarItems = ['ColumnChooser', 'Add', 'Edit', 'Delete', 'Update', 'Cancel'];\n      }\n    }\n\n    var drillThroughGrid = createElement('div', {\n      id: this.parent.element.id + '_drillthroughgrid',\n      className: cls.DRILLTHROUGH_GRID_CLASS\n    });\n    Grid.Inject(Selection, Reorder, Resize, Toolbar, ColumnChooser);\n    this.drillThroughGrid = new Grid({\n      gridLines: 'Default',\n      allowResizing: true,\n      allowReordering: true,\n      showColumnChooser: true,\n      enableHover: false,\n      toolbar: toolbarItems,\n      columns: eventArgs.gridColumns,\n      locale: this.parent.locale,\n      enableRtl: this.parent.enableRtl,\n      enableVirtualization: !this.parent.editSettings.allowEditing,\n      allowPaging: this.parent.editSettings.allowEditing,\n      pageSettings: {\n        pageSize: 20\n      },\n      rowHeight: this.parent.gridSettings.rowHeight\n    });\n\n    if (isBlazor()) {\n      this.drillThroughGrid['isJsComponent'] = true;\n    }\n\n    if (this.parent.dataType === 'olap') {\n      this.formatData();\n    }\n\n    var dialogModule = this;\n    this.parent.trigger(events.beginDrillThrough, {\n      cellInfo: eventArgs,\n      gridObj: isBlazor() ? undefined : this.drillThroughGrid,\n      type: 'editing'\n    });\n\n    if (this.drillThroughGrid.allowExcelExport) {\n      Grid.Inject(ExcelExport);\n    }\n\n    if (this.drillThroughGrid.allowPdfExport) {\n      Grid.Inject(PdfExport);\n    }\n\n    if (this.parent.editSettings.allowEditing) {\n      Grid.Inject(Edit, Page);\n      this.drillThroughGrid.editSettings = this.parent.editSettings;\n\n      if (this.parent.editSettings.allowCommandColumns) {\n        this.drillThroughGrid.editSettings.mode = 'Normal';\n        this.drillThroughGrid.editSettings.allowEditOnDblClick = false;\n        Grid.Inject(CommandColumn);\n        this.drillThroughGrid.columns.push({\n          headerText: this.parent.localeObj.getConstant('manageRecords'),\n          width: 160,\n          showInColumnChooser: false,\n          commands: [{\n            type: 'Edit',\n            buttonOption: {\n              iconCss: ' e-icons e-edit',\n              cssClass: 'e-flat'\n            }\n          }, {\n            type: 'Delete',\n            buttonOption: {\n              iconCss: 'e-icons e-delete',\n              cssClass: 'e-flat'\n            }\n          }, {\n            type: 'Save',\n            buttonOption: {\n              iconCss: 'e-icons e-update',\n              cssClass: 'e-flat'\n            }\n          }, {\n            type: 'Cancel',\n            buttonOption: {\n              iconCss: 'e-icons e-cancel-icon',\n              cssClass: 'e-flat'\n            }\n          }]\n        });\n      } else {\n        this.drillThroughGrid.editSettings.allowEditOnDblClick = this.parent.editSettings.allowEditOnDblClick;\n      }\n\n      this.drillThroughGrid.columns.push({\n        field: '__index',\n        visible: false,\n        isPrimaryKey: true,\n        type: 'string',\n        showInColumnChooser: false\n      });\n\n      this.drillThroughGrid.actionComplete = function (args) {\n        if (args.requestType === 'batchsave' || args.requestType === 'save' || args.requestType === 'delete') {\n          dialogModule.isUpdated = true;\n        }\n\n        if (dialogModule.drillThroughGrid.editSettings.mode === 'Normal' && args.requestType === 'save' && dialogModule.drillThroughGrid.element.querySelectorAll('.e-tbar-btn:hover').length > 0 && !dialogModule.parent.editSettings.allowCommandColumns || args.requestType === 'batchsave') {\n          dialogModule.dialogPopUp.hide();\n        }\n      };\n\n      this.drillThroughGrid.beforeBatchSave = function () {\n        dialogModule.isUpdated = true;\n      };\n      /* eslint-enable @typescript-eslint/indent */\n\n    } else {\n      Grid.Inject(VirtualScroll);\n    }\n\n    document.body.appendChild(drillThroughGrid);\n    this.drillThroughGrid.isStringTemplate = true;\n    this.drillThroughGrid.appendTo(drillThroughGrid);\n    drillThroughBody.appendChild(drillThroughBodyHeader);\n    drillThroughBody.appendChild(drillThroughGrid);\n    return drillThroughBody;\n  };\n  /** @hidden */\n\n\n  DrillThroughDialog.prototype.frameGridColumns = function (rawData) {\n    var keys = this.parent.dataType === 'olap' ? rawData[0] ? Object.keys(rawData[0]) : [] : Object.keys(this.engine.fieldList);\n    var columns = [];\n\n    if (this.parent.dataSourceSettings.formatSettings.length > 0) {\n      for (var i = 0; i < this.parent.dataSourceSettings.formatSettings.length; i++) {\n        this.formatList[this.parent.dataSourceSettings.formatSettings[i].name] = this.parent.dataSourceSettings.formatSettings[i].format;\n      }\n    }\n\n    if (this.parent.dataType === 'olap') {\n      for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        columns.push({\n          field: key.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g, '').replace('].[', '').split('.').reverse().join(''),\n          headerText: key.replace(/_x005B_|_x005D_|_x0024_/g, '').replace(/_x0020_/g, ' ').replace('].[', '').split('.').reverse().join('.'),\n          width: 120,\n          visible: true,\n          validationRules: {\n            required: true\n          },\n          format: !isNullOrUndefined(this.formatList[key]) ? this.formatList[key] : null,\n          type: !isNullOrUndefined(this.formatList[key]) ? null : 'string'\n        });\n      }\n    } else {\n      for (var _a = 0, keys_2 = keys; _a < keys_2.length; _a++) {\n        var key = keys_2[_a];\n\n        if (this.engine.fieldList[key].aggregateType !== 'CalculatedField') {\n          var editType = '';\n          var isDateField = (this.engine.fieldList[key].type === 'date' || this.engine.fieldList[key].type === 'datetime') && (this.isDateFieldExist(key) || rawData[0] && rawData[0][key] && rawData[0][key].toString().indexOf(' ') === -1) ? true : false;\n\n          if (this.engine.fieldList[key].type === 'number') {\n            editType = 'numericedit';\n          } else if (this.engine.fieldList[key].type === 'date' && isDateField) {\n            editType = 'datepickeredit';\n          } else if (this.engine.fieldList[key].type === 'datetime' && isDateField) {\n            editType = 'datetimepickeredit';\n          } else {\n            editType = 'defaultedit';\n          }\n\n          columns.push({\n            field: key,\n            headerText: this.engine.fieldList[key].caption,\n            width: 120,\n            visible: this.engine.fieldList[key].isSelected,\n            validationRules: {\n              required: true\n            },\n            editType: editType,\n            format: !isNullOrUndefined(this.formatList[key]) ? this.formatList[key] : undefined,\n            type: !isNullOrUndefined(this.formatList[key]) ? null : 'string'\n          });\n        }\n      }\n    }\n\n    return columns;\n  };\n\n  DrillThroughDialog.prototype.isDateFieldExist = function (key) {\n    for (var len = 0; len < this.parent.dataSourceSettings.formatSettings.length; len++) {\n      if (this.parent.dataSourceSettings.formatSettings[len].name === key && this.parent.dataSourceSettings.formatSettings[len].type.indexOf('date') > -1) {\n        return true;\n      }\n    }\n\n    for (var len = 0; len < this.parent.dataSourceSettings.fieldMapping.length; len++) {\n      if (this.parent.dataSourceSettings.fieldMapping[len].name === key && this.parent.dataSourceSettings.fieldMapping[len].dataType.indexOf('date') > -1) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  DrillThroughDialog.prototype.formatData = function () {\n    var index = 0;\n\n    while (index < this.gridData.length) {\n      var data = this.gridData[index];\n      var keys = Object.keys(this.gridData[index]);\n      var newData = {};\n      var i = 0;\n\n      while (i < keys.length) {\n        var key = keys[i].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g, '').replace('].[', '').split('.').reverse().join('');\n        newData[key] = data[keys[i]];\n        i++;\n      }\n\n      this.gridData[index] = newData;\n      index++;\n    }\n  };\n\n  DrillThroughDialog.prototype.dataWithPrimarykey = function (eventArgs) {\n    var indexString = this.indexString.length > 0 ? this.indexString : Object.keys(eventArgs.currentCell.indexObject);\n    var rawData = this.gridData;\n    var count = 0;\n\n    for (var _i = 0, rawData_1 = rawData; _i < rawData_1.length; _i++) {\n      var item = rawData_1[_i];\n      item['__index'] = indexString[count];\n      this.gridIndexObjects[indexString[count].toString()] = Number(indexString[count]);\n      count++;\n    }\n\n    return rawData;\n  };\n\n  return DrillThroughDialog;\n}();\n\nexport { DrillThroughDialog };","map":{"version":3,"sources":["/workspace/Commb-olap-poc/commb-olap-js/node_modules/@syncfusion/ej2-pivotview/src/common/popups/drillthrough-dialog.js"],"names":["Dialog","createElement","setStyleAttribute","remove","isNullOrUndefined","isBlazor","cls","Grid","Reorder","Resize","ColumnChooser","Toolbar","ExcelExport","PdfExport","VirtualScroll","Selection","Edit","Page","CommandColumn","events","NumericTextBox","DrillThroughDialog","parent","indexString","clonedData","isUpdated","gridIndexObjects","gridData","formatList","engine","dataType","olapEngineModule","engineModule","prototype","frameHeaderWithKeys","header","keys","Object","keyPos","framedHeader","length","showDrillThroughDialog","eventArgs","_this","rawData","i","push","actualText","currentCell","toString","fieldList","aggregateType","editSettings","allowInlineEditing","allowEditing","editCell","removeDrillThroughDialog","drillThroughDialog","id","element","className","DRILLTHROUGH_DIALOG","appendChild","dialogPopUp","animationSettings","effect","allowDragging","localeObj","getConstant","content","createDrillThroughGrid","beforeOpen","drillThroughGrid","setProperties","dataSource","dataWithPrimarykey","height","beforeClose","dataSourceSettings","type","updateData","gridIndexObjectsValue","previousPosition","_i","gridIndexObjectsValue_1","value","count","addItems","prevItems","index","_a","_b","item","_c","_d","fields","field","allowCommandColumns","data","Number","mode","enableVirtualization","currModule_1","interopAdaptor","invokeMethodAsync","then","updateBlazorData","allowServerDataBinding","pivotValues","bulkChanges","gridIndex","len","drillThroughValue","indexObject","Key","Value","getEngine","items","allowDataCompression","actualData","_e","_f","undefined","concat","eventArgs_1","currentData","previousData","cancel","trigger","editCompleted","updateGridData","isModal","visible","showCloseIcon","locale","enableRtl","width","isAdaptive","position","X","Y","closeOnEscape","target","document","body","close","bind","isStringTemplate","appendTo","gridResize","gridSettings","allowResizing","currentTarget","firstElementChild","style","display","cellValue","actualValue","numericTextBox","enabled","format","change","textBoxValue","indexValue","blur","textBoxElement","focusIn","dataPos","framedSet","fieldKeys","isDestroyed","destroy","dialogElement","getElementById","drillThroughBody","DRILLTHROUGH_BODY_CLASS","drillThroughBodyHeader","DRILLTHROUGH_BODY_HEADER_CONTAINER_CLASS","rowHeaders","innerHTML","DRILLTHROUGH_BODY_HEADER_COMMON_CLASS","DRILLTHROUGH_BODY_HEADER_CLASS","DRILLTHROUGH_BODY_HEADER_VALUE_CLASS","columnHeaders","measure","split","toolbarItems","DRILLTHROUGH_GRID_CLASS","Inject","gridLines","allowReordering","showColumnChooser","enableHover","toolbar","columns","gridColumns","allowPaging","pageSettings","pageSize","rowHeight","formatData","dialogModule","beginDrillThrough","cellInfo","gridObj","allowExcelExport","allowPdfExport","allowEditOnDblClick","headerText","showInColumnChooser","commands","buttonOption","iconCss","cssClass","isPrimaryKey","actionComplete","args","requestType","querySelectorAll","hide","beforeBatchSave","frameGridColumns","formatSettings","name","keys_1","key","replace","reverse","join","validationRules","required","keys_2","editType","isDateField","isDateFieldExist","indexOf","caption","isSelected","fieldMapping","newData","rawData_1"],"mappings":"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","sourcesContent":["import { Dialog } from '@syncfusion/ej2-popups';\nimport { createElement, setStyleAttribute, remove, isNullOrUndefined, isBlazor } from '@syncfusion/ej2-base';\nimport * as cls from '../../common/base/css-constant';\nimport { Grid, Reorder, Resize, ColumnChooser, Toolbar, ExcelExport, PdfExport } from '@syncfusion/ej2-grids';\nimport { VirtualScroll, Selection, Edit, Page, CommandColumn } from '@syncfusion/ej2-grids';\nimport * as events from '../../common/base/constant';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * `DrillThroughDialog` module to create drill-through dialog.\n */\n/** @hidden */\nvar DrillThroughDialog = /** @class */ (function () {\n    /* eslint-disable-next-line */\n    /**\n     * Constructor for the dialog action.\n     * @hidden\n     */\n    function DrillThroughDialog(parent) {\n        /** @hidden */\n        this.indexString = [];\n        this.clonedData = [];\n        this.isUpdated = false;\n        this.gridIndexObjects = {};\n        this.gridData = [];\n        this.formatList = {};\n        this.parent = parent;\n        this.engine = this.parent.dataType === 'olap' ? this.parent.olapEngineModule : this.parent.engineModule;\n    }\n    DrillThroughDialog.prototype.frameHeaderWithKeys = function (header) {\n        var keys = Object.keys(header);\n        var keyPos = 0;\n        var framedHeader = {}; /* eslint-disable-line */\n        while (keyPos < keys.length) {\n            framedHeader[keys[keyPos]] = header[keys[keyPos]];\n            keyPos++;\n        }\n        return framedHeader;\n    };\n    /* eslint-disable-next-line */\n    /** @hidden */\n    DrillThroughDialog.prototype.showDrillThroughDialog = function (eventArgs) {\n        var _this = this;\n        this.gridData = eventArgs.rawData;\n        for (var i = 0; i < eventArgs.rawData.length; i++) {\n            this.clonedData.push(this.frameHeaderWithKeys(eventArgs.rawData[i]));\n        }\n        var actualText = eventArgs.currentCell.actualText.toString();\n        if (this.engine.fieldList[actualText].aggregateType !== 'Count' && this.parent.editSettings.allowInlineEditing &&\n            this.parent.editSettings.allowEditing && eventArgs.rawData.length === 1 &&\n            this.engine.fieldList[actualText].aggregateType !== 'DistinctCount' && typeof (eventArgs.rawData[0][actualText]) !== 'string') {\n            this.editCell(eventArgs);\n        }\n        else {\n            this.removeDrillThroughDialog();\n            var drillThroughDialog = createElement('div', {\n                id: this.parent.element.id + '_drillthrough',\n                className: cls.DRILLTHROUGH_DIALOG\n            });\n            this.parent.element.appendChild(drillThroughDialog);\n            this.dialogPopUp = new Dialog({\n                animationSettings: { effect: 'Fade' },\n                allowDragging: false,\n                header: this.parent.localeObj.getConstant('details'),\n                content: this.createDrillThroughGrid(eventArgs),\n                beforeOpen: function () {\n                    _this.drillThroughGrid.setProperties({\n                        dataSource: _this.parent.editSettings.allowEditing ?\n                            _this.dataWithPrimarykey(eventArgs) : _this.gridData,\n                        height: !_this.parent.editSettings.allowEditing ? 300 : 220\n                    }, false);\n                },\n                beforeClose: function () {\n                    if (_this.parent.editSettings.allowEditing && _this.isUpdated) {\n                        if (_this.parent.dataSourceSettings.type === 'CSV') {\n                            _this.updateData(_this.drillThroughGrid.dataSource);\n                        }\n                        var gridIndexObjectsValue = Object.keys(_this.gridIndexObjects);\n                        var previousPosition = [];\n                        for (var _i = 0, gridIndexObjectsValue_1 = gridIndexObjectsValue; _i < gridIndexObjectsValue_1.length; _i++) {\n                            var value = gridIndexObjectsValue_1[_i];\n                            previousPosition.push(_this.gridIndexObjects[value]);\n                        }\n                        var count = Object.keys(_this.gridIndexObjects).length;\n                        var addItems = [];\n                        var prevItems = [];\n                        var index = 0;\n                        /* eslint-disable @typescript-eslint/dot-notation */\n                        for (var _a = 0, _b = _this.drillThroughGrid.dataSource; _a < _b.length; _a++) {\n                            var item = _b[_a];\n                            if (isNullOrUndefined(item['__index']) || item['__index'] === '') {\n                                for (var _c = 0, _d = _this.engine.fields; _c < _d.length; _c++) {\n                                    var field = _d[_c];\n                                    if (isNullOrUndefined(item[field])) {\n                                        delete item[field];\n                                    }\n                                }\n                                delete item['__index'];\n                                addItems.push(item);\n                            }\n                            else if (count > 0) {\n                                if (isBlazor() && _this.parent.editSettings.allowCommandColumns) {\n                                    _this.parent.engineModule.data[Number(item['__index'])] = item;\n                                }\n                                delete _this.gridIndexObjects[item['__index'].toString()];\n                                prevItems.push(item);\n                                count--;\n                            }\n                            if (_this.parent.dataSourceSettings.mode === 'Server') {\n                                if (item['__index']) {\n                                    delete item['__index'];\n                                }\n                                if (_this.gridData[index]['__index']) {\n                                    delete _this.gridData[index]['__index'];\n                                }\n                            }\n                            index++;\n                        }\n                        count = 0;\n                        if (isBlazor() && _this.parent.enableVirtualization) {\n                            var currModule_1 = _this; /* eslint-disable-line */\n                            /* eslint-disable @typescript-eslint/no-explicit-any */\n                            currModule_1.parent.interopAdaptor.invokeMethodAsync('PivotInteropMethod', 'updateRawData', {\n                                'AddItem': addItems, 'RemoveItem': currModule_1.gridIndexObjects, 'ModifiedItem': currModule_1.gridData /* eslint-disable-line */\n                            }).then(function (data) {\n                                currModule_1.parent.updateBlazorData(data, currModule_1.parent);\n                                currModule_1.parent.allowServerDataBinding = false;\n                                currModule_1.parent.setProperties({ pivotValues: currModule_1.parent.engineModule.pivotValues }, true);\n                                delete currModule_1.parent.bulkChanges.pivotValues;\n                                currModule_1.parent.allowServerDataBinding = true;\n                                currModule_1.isUpdated = false;\n                                currModule_1.gridIndexObjects = {};\n                            });\n                            /* eslint-enable @typescript-eslint/no-explicit-any */\n                        }\n                        else if (_this.parent.dataSourceSettings.mode === 'Server') {\n                            var gridIndex = []; /* eslint-disable-line */\n                            var keys = Object.keys(_this.gridIndexObjects);\n                            for (var len = 0; len < keys.length; len++) {\n                                delete _this.parent.drillThroughValue.indexObject[_this.gridIndexObjects[keys[len]]];\n                                gridIndex.push({ Key: keys[len], Value: _this.gridIndexObjects[keys[len]] }); /* eslint-disable-line */\n                            }\n                            var indexObject = []; /* eslint-disable-line */\n                            keys = Object.keys(_this.parent.drillThroughValue.indexObject);\n                            for (var len = 0; len < keys.length; len++) {\n                                indexObject.push({ Key: keys[len], Value: _this.parent.drillThroughValue.indexObject[keys[len]] }); /* eslint-disable-line */\n                            }\n                            _this.parent.getEngine('updateRawData', null, null, null, null, null, null, null, { 'addedData': addItems, 'removedData': gridIndex, 'updatedData': prevItems, indexObject: indexObject });\n                        }\n                        else {\n                            var items = [];\n                            var data = (_this.parent.allowDataCompression && _this.parent.enableVirtualization) ?\n                                _this.parent.engineModule.actualData : _this.parent.engineModule.data;\n                            for (var _e = 0, _f = data; _e < _f.length; _e++) {\n                                var item = _f[_e];\n                                delete item['__index'];\n                                if (_this.gridIndexObjects[count.toString()] === undefined) {\n                                    items.push(item);\n                                }\n                                count++;\n                            }\n                            /* eslint-enable @typescript-eslint/dot-notation */\n                            items = items.concat(addItems);\n                            var eventArgs_1 = {\n                                currentData: _this.drillThroughGrid.dataSource,\n                                previousData: _this.clonedData,\n                                previousPosition: previousPosition,\n                                cancel: false\n                            };\n                            _this.parent.trigger(events.editCompleted, eventArgs_1);\n                            if (!eventArgs_1.cancel) {\n                                _this.parent.setProperties({ dataSourceSettings: { dataSource: items } }, true);\n                                _this.engine.updateGridData(_this.parent.dataSourceSettings);\n                                _this.parent.pivotValues = _this.engine.pivotValues;\n                            }\n                        }\n                    }\n                    if (!(isBlazor() && _this.parent.enableVirtualization)) {\n                        _this.isUpdated = false;\n                        _this.gridIndexObjects = {};\n                    }\n                },\n                isModal: true,\n                visible: true,\n                showCloseIcon: true,\n                locale: this.parent.locale,\n                enableRtl: this.parent.enableRtl,\n                width: this.parent.isAdaptive ? '100%' : '60%',\n                position: { X: 'center', Y: 'center' },\n                closeOnEscape: true,\n                target: document.body,\n                close: this.removeDrillThroughDialog.bind(this)\n            });\n            this.dialogPopUp.isStringTemplate = true;\n            this.dialogPopUp.appendTo(drillThroughDialog);\n            // this.dialogPopUp.element.querySelector('.e-dlg-header').innerHTML = this.parent.localeObj.getConstant('details');\n            setStyleAttribute(this.dialogPopUp.element, { 'visibility': 'visible' });\n        }\n    };\n    DrillThroughDialog.prototype.editCell = function (eventArgs) {\n        var _this = this;\n        var gridResize = this.parent.gridSettings.allowResizing;\n        var actualText = eventArgs.currentCell.actualText.toString();\n        var indexObject = Number(Object.keys(eventArgs.currentCell.indexObject));\n        eventArgs.currentTarget.firstElementChild.style.display = 'none';\n        var cellValue = Number(eventArgs.rawData[0][actualText]);\n        /* eslint-disable */\n        var previousData = this.frameHeaderWithKeys(eventArgs.rawData[eventArgs.rawData.length - 1]);\n        var currentData = eventArgs.rawData[eventArgs.rawData.length - 1];\n        /* eslint-enable */\n        if (eventArgs.currentCell.actualText in previousData) {\n            currentData[eventArgs.currentCell.actualText] = eventArgs.currentCell.actualValue;\n        }\n        this.numericTextBox = new NumericTextBox({\n            value: cellValue,\n            enableRtl: this.parent.enableRtl,\n            enabled: true,\n            format: '####.##',\n            locale: this.parent.locale,\n            change: function () {\n                var textBoxValue = _this.numericTextBox.value;\n                var indexValue = eventArgs.currentCell.indexObject[indexObject];\n                eventArgs.rawData[0][actualText] = textBoxValue;\n                _this.parent.engineModule.data[indexValue] = eventArgs.rawData[0];\n            },\n            blur: function () {\n                var eventArgs = {\n                    currentData: currentData,\n                    previousData: previousData,\n                    previousPosition: currentData.index,\n                    cancel: false\n                };\n                _this.parent.trigger(events.editCompleted, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.parent.setProperties({ dataSourceSettings: { dataSource: _this.parent.engineModule.data } }, true);\n                    _this.engine.updateGridData(_this.parent.dataSourceSettings);\n                    _this.parent.pivotValues = _this.engine.pivotValues;\n                    _this.parent.gridSettings.allowResizing = gridResize;\n                }\n            }\n        });\n        var textBoxElement = createElement('input', {\n            id: this.parent.element.id + '_inputbox'\n        });\n        eventArgs.currentTarget.appendChild(textBoxElement);\n        this.numericTextBox.appendTo(textBoxElement);\n        eventArgs.currentCell.value = this.numericTextBox.value;\n        this.numericTextBox.focusIn();\n        this.parent.gridSettings.allowResizing = false;\n    };\n    /* eslint-disable , @typescript-eslint/no-explicit-any */\n    DrillThroughDialog.prototype.updateData = function (dataSource) {\n        var dataPos = 0;\n        var data = (this.parent.allowDataCompression && this.parent.enableVirtualization) ?\n            this.parent.engineModule.actualData : this.parent.engineModule.data;\n        while (dataPos < dataSource.length) {\n            var fields = Object.keys(dataSource[dataPos]);\n            var keyPos = 0;\n            var framedSet = [];\n            while (keyPos < fields.length) {\n                if (!isNullOrUndefined(this.parent.engineModule.fieldKeys[fields[keyPos]])) {\n                    framedSet[this.parent.engineModule.fieldKeys[fields[keyPos]]] = dataSource[dataPos][fields[keyPos]];\n                }\n                keyPos++;\n            }\n            data[dataSource[dataPos]['__index']] = framedSet; /* eslint-disable-line */\n            dataPos++;\n        }\n        if (this.parent.allowDataCompression && this.parent.enableVirtualization) {\n            this.parent.engineModule.actualData = data;\n        }\n        else {\n            this.parent.engineModule.data = data;\n        }\n    };\n    DrillThroughDialog.prototype.removeDrillThroughDialog = function () {\n        if (this.dialogPopUp && !this.dialogPopUp.isDestroyed) {\n            this.dialogPopUp.destroy();\n        }\n        var dialogElement = document.getElementById(this.parent.element.id + '_drillthrough');\n        if (dialogElement) {\n            remove(dialogElement);\n        }\n        if (document.getElementById(this.parent.element.id + '_drillthroughgrid_ccdlg')) {\n            remove(document.getElementById(this.parent.element.id + '_drillthroughgrid_ccdlg'));\n        }\n    };\n    /* eslint-disable  */\n    DrillThroughDialog.prototype.createDrillThroughGrid = function (eventArgs) {\n        var drillThroughBody = createElement('div', { id: this.parent.element.id + '_drillthroughbody', className: cls.DRILLTHROUGH_BODY_CLASS });\n        var drillThroughBodyHeader = createElement('div', {\n            id: this.parent.element.id +\n                '_drillthroughbodyheader', className: cls.DRILLTHROUGH_BODY_HEADER_CONTAINER_CLASS\n        });\n        if (eventArgs.rowHeaders !== '') {\n            drillThroughBodyHeader.innerHTML = '<span class=' +\n                cls.DRILLTHROUGH_BODY_HEADER_COMMON_CLASS + '><span class=' + cls.DRILLTHROUGH_BODY_HEADER_CLASS + '>' +\n                this.parent.localeObj.getConstant('row') + '</span> :<span class=' +\n                cls.DRILLTHROUGH_BODY_HEADER_VALUE_CLASS + '>' + eventArgs.rowHeaders + '</span></span>';\n        }\n        if (eventArgs.columnHeaders !== '') {\n            drillThroughBodyHeader.innerHTML = drillThroughBodyHeader.innerHTML + '<span class=' +\n                cls.DRILLTHROUGH_BODY_HEADER_COMMON_CLASS + '><span class=' +\n                cls.DRILLTHROUGH_BODY_HEADER_CLASS + '>' + this.parent.localeObj.getConstant('column') +\n                '</span> :<span class=' + cls.DRILLTHROUGH_BODY_HEADER_VALUE_CLASS + '>' +\n                eventArgs.columnHeaders + '</span></span>';\n        }\n        if (eventArgs.value !== '') {\n            var measure = eventArgs.value.split('(')[0];\n            var value = eventArgs.value.split('(')[1].split(')')[0];\n            if (value !== '0') {\n                drillThroughBodyHeader.innerHTML = drillThroughBodyHeader.innerHTML + '<span class=' +\n                    cls.DRILLTHROUGH_BODY_HEADER_COMMON_CLASS + '><span class=' +\n                    cls.DRILLTHROUGH_BODY_HEADER_CLASS + '>' +\n                    measure + '</span> :<span class=' + cls.DRILLTHROUGH_BODY_HEADER_VALUE_CLASS + '>' + value + '</span></span>';\n            }\n        }\n        var toolbarItems = ['ColumnChooser'];\n        if (this.parent.editSettings.allowEditing) {\n            if (this.parent.editSettings.allowCommandColumns) {\n                toolbarItems = ['ColumnChooser', 'Add'];\n            }\n            else if (this.parent.editSettings.mode === 'Batch') {\n                toolbarItems = ['ColumnChooser', 'Add', 'Delete', 'Update', 'Cancel'];\n            }\n            else if (this.parent.editSettings.mode === 'Dialog') {\n                toolbarItems = ['ColumnChooser', 'Add', 'Edit', 'Delete'];\n            }\n            else {\n                toolbarItems = ['ColumnChooser', 'Add', 'Edit', 'Delete', 'Update', 'Cancel'];\n            }\n        }\n        var drillThroughGrid = createElement('div', { id: this.parent.element.id + '_drillthroughgrid', className: cls.DRILLTHROUGH_GRID_CLASS });\n        Grid.Inject(Selection, Reorder, Resize, Toolbar, ColumnChooser);\n        this.drillThroughGrid = new Grid({\n            gridLines: 'Default',\n            allowResizing: true,\n            allowReordering: true,\n            showColumnChooser: true,\n            enableHover: false,\n            toolbar: toolbarItems,\n            columns: eventArgs.gridColumns,\n            locale: this.parent.locale,\n            enableRtl: this.parent.enableRtl,\n            enableVirtualization: !this.parent.editSettings.allowEditing,\n            allowPaging: this.parent.editSettings.allowEditing,\n            pageSettings: { pageSize: 20 },\n            rowHeight: this.parent.gridSettings.rowHeight\n        });\n        if (isBlazor()) {\n            this.drillThroughGrid['isJsComponent'] = true;\n        }\n        if (this.parent.dataType === 'olap') {\n            this.formatData();\n        }\n        var dialogModule = this;\n        this.parent.trigger(events.beginDrillThrough, {\n            cellInfo: eventArgs,\n            gridObj: isBlazor() ? undefined : this.drillThroughGrid,\n            type: 'editing'\n        });\n        if (this.drillThroughGrid.allowExcelExport) {\n            Grid.Inject(ExcelExport);\n        }\n        if (this.drillThroughGrid.allowPdfExport) {\n            Grid.Inject(PdfExport);\n        }\n        if (this.parent.editSettings.allowEditing) {\n            Grid.Inject(Edit, Page);\n            this.drillThroughGrid.editSettings = this.parent.editSettings;\n            if (this.parent.editSettings.allowCommandColumns) {\n                this.drillThroughGrid.editSettings.mode = 'Normal';\n                this.drillThroughGrid.editSettings.allowEditOnDblClick = false;\n                Grid.Inject(CommandColumn);\n                this.drillThroughGrid.columns.push({\n                    headerText: this.parent.localeObj.getConstant('manageRecords'), width: 160, showInColumnChooser: false,\n                    commands: [\n                        { type: 'Edit', buttonOption: { iconCss: ' e-icons e-edit', cssClass: 'e-flat' } },\n                        { type: 'Delete', buttonOption: { iconCss: 'e-icons e-delete', cssClass: 'e-flat' } },\n                        { type: 'Save', buttonOption: { iconCss: 'e-icons e-update', cssClass: 'e-flat' } },\n                        { type: 'Cancel', buttonOption: { iconCss: 'e-icons e-cancel-icon', cssClass: 'e-flat' } }\n                    ]\n                });\n            }\n            else {\n                this.drillThroughGrid.editSettings.allowEditOnDblClick = this.parent.editSettings.allowEditOnDblClick;\n            }\n            this.drillThroughGrid.columns.push({\n                field: '__index', visible: false, isPrimaryKey: true, type: 'string', showInColumnChooser: false\n            });\n            this.drillThroughGrid.actionComplete = function (args) {\n                if (args.requestType === 'batchsave' || args.requestType === 'save' || args.requestType === 'delete') {\n                    dialogModule.isUpdated = true;\n                }\n                if ((dialogModule.drillThroughGrid.editSettings.mode === 'Normal' && args.requestType === 'save' &&\n                    dialogModule.drillThroughGrid.element.querySelectorAll('.e-tbar-btn:hover').length > 0 &&\n                    !dialogModule.parent.editSettings.allowCommandColumns) || args.requestType === 'batchsave') {\n                    dialogModule.dialogPopUp.hide();\n                }\n            };\n            this.drillThroughGrid.beforeBatchSave = function () {\n                dialogModule.isUpdated = true;\n            };\n            /* eslint-enable @typescript-eslint/indent */\n        }\n        else {\n            Grid.Inject(VirtualScroll);\n        }\n        document.body.appendChild(drillThroughGrid);\n        this.drillThroughGrid.isStringTemplate = true;\n        this.drillThroughGrid.appendTo(drillThroughGrid);\n        drillThroughBody.appendChild(drillThroughBodyHeader);\n        drillThroughBody.appendChild(drillThroughGrid);\n        return drillThroughBody;\n    };\n    /** @hidden */\n    DrillThroughDialog.prototype.frameGridColumns = function (rawData) {\n        var keys = this.parent.dataType === 'olap' ? rawData[0] ? Object.keys(rawData[0]) : [] :\n            Object.keys(this.engine.fieldList);\n        var columns = [];\n        if (this.parent.dataSourceSettings.formatSettings.length > 0) {\n            for (var i = 0; i < this.parent.dataSourceSettings.formatSettings.length; i++) {\n                this.formatList[this.parent.dataSourceSettings.formatSettings[i].name] = this.parent.dataSourceSettings.formatSettings[i].format;\n            }\n        }\n        if (this.parent.dataType === 'olap') {\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n                var key = keys_1[_i];\n                columns.push({\n                    field: key.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g, '').replace('].[', '').split('.').reverse().join(''),\n                    headerText: key.replace(/_x005B_|_x005D_|_x0024_/g, '').replace(/_x0020_/g, ' ').\n                        replace('].[', '').split('.').reverse().join('.'),\n                    width: 120,\n                    visible: true,\n                    validationRules: { required: true },\n                    format: !isNullOrUndefined(this.formatList[key]) ? this.formatList[key] : null,\n                    type: !isNullOrUndefined(this.formatList[key]) ? null : 'string'\n                });\n            }\n        }\n        else {\n            for (var _a = 0, keys_2 = keys; _a < keys_2.length; _a++) {\n                var key = keys_2[_a];\n                if (this.engine.fieldList[key].aggregateType !== 'CalculatedField') {\n                    var editType = '';\n                    var isDateField = ((this.engine.fieldList[key].type === 'date' || this.engine.fieldList[key].type === 'datetime')\n                        && (this.isDateFieldExist(key) || (rawData[0] && rawData[0][key] && rawData[0][key].toString().indexOf(' ') === -1))) ? true : false;\n                    if (this.engine.fieldList[key].type === 'number') {\n                        editType = 'numericedit';\n                    }\n                    else if (this.engine.fieldList[key].type === 'date' && isDateField) {\n                        editType = 'datepickeredit';\n                    }\n                    else if (this.engine.fieldList[key].type === 'datetime' && isDateField) {\n                        editType = 'datetimepickeredit';\n                    }\n                    else {\n                        editType = 'defaultedit';\n                    }\n                    columns.push({\n                        field: key,\n                        headerText: this.engine.fieldList[key].caption,\n                        width: 120,\n                        visible: this.engine.fieldList[key].isSelected,\n                        validationRules: { required: true },\n                        editType: editType,\n                        format: !isNullOrUndefined(this.formatList[key]) ? this.formatList[key] : undefined,\n                        type: !isNullOrUndefined(this.formatList[key]) ? null : 'string'\n                    });\n                }\n            }\n        }\n        return columns;\n    };\n    DrillThroughDialog.prototype.isDateFieldExist = function (key) {\n        for (var len = 0; len < this.parent.dataSourceSettings.formatSettings.length; len++) {\n            if (this.parent.dataSourceSettings.formatSettings[len].name === key &&\n                this.parent.dataSourceSettings.formatSettings[len].type.indexOf('date') > -1) {\n                return true;\n            }\n        }\n        for (var len = 0; len < this.parent.dataSourceSettings.fieldMapping.length; len++) {\n            if (this.parent.dataSourceSettings.fieldMapping[len].name === key &&\n                this.parent.dataSourceSettings.fieldMapping[len].dataType.indexOf('date') > -1) {\n                return true;\n            }\n        }\n        return false;\n    };\n    DrillThroughDialog.prototype.formatData = function () {\n        var index = 0;\n        while (index < this.gridData.length) {\n            var data = this.gridData[index];\n            var keys = Object.keys(this.gridData[index]);\n            var newData = {};\n            var i = 0;\n            while (i < keys.length) {\n                var key = keys[i].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g, '').replace('].[', '').split('.').reverse().join('');\n                newData[key] = data[keys[i]];\n                i++;\n            }\n            this.gridData[index] = newData;\n            index++;\n        }\n    };\n    DrillThroughDialog.prototype.dataWithPrimarykey = function (eventArgs) {\n        var indexString = this.indexString.length > 0 ? this.indexString : Object.keys(eventArgs.currentCell.indexObject);\n        var rawData = this.gridData;\n        var count = 0;\n        for (var _i = 0, rawData_1 = rawData; _i < rawData_1.length; _i++) {\n            var item = rawData_1[_i];\n            item['__index'] = indexString[count];\n            this.gridIndexObjects[indexString[count].toString()] = Number(indexString[count]);\n            count++;\n        }\n        return rawData;\n    };\n    return DrillThroughDialog;\n}());\nexport { DrillThroughDialog };\n"]},"metadata":{},"sourceType":"module"}