{"ast":null,"code":"import { KeyboardEvents, closest, addClass, isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport * as cls from '../../common/base/css-constant';\nimport * as events from '../../common/base/constant';\n/**\n * PivotView Keyboard interaction\n */\n\n/** @hidden */\n\nvar KeyboardInteraction = function () {\n  /**\n   * Constructor.\n   * @param {PivotView} parent - Instance of pivot table.\n   */\n  function KeyboardInteraction(parent) {\n    this.keyConfigs = {\n      tab: 'tab',\n      shiftTab: 'shift+tab',\n      enter: 'enter',\n      shiftUp: 'shift+upArrow',\n      shiftDown: 'shift+downArrow',\n      shiftLeft: 'shift+leftArrow',\n      shiftRight: 'shift+rightArrow',\n      shiftEnter: 'shift+enter',\n      ctrlEnter: 'ctrl+enter',\n      upArrow: 'upArrow',\n      downArrow: 'downArrow',\n      leftArrow: 'leftArrow',\n      rightArrow: 'rightArrow',\n      escape: 'escape',\n      ctrlShiftF: 'ctrl+shift+f'\n    };\n    this.parent = parent;\n    this.event = undefined;\n    this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n    this.pivotViewKeyboardModule = new KeyboardEvents(this.parent.element, {\n      keyAction: this.keyActionHandler.bind(this),\n      keyConfigs: this.keyConfigs,\n      eventName: 'keydown'\n    });\n  }\n\n  KeyboardInteraction.prototype.keyActionHandler = function (e) {\n    switch (e.action) {\n      case 'tab':\n        this.processTab(e);\n        break;\n\n      case 'shiftTab':\n        this.processShiftTab(e);\n        break;\n\n      case 'enter':\n      case 'shiftEnter':\n      case 'ctrlEnter':\n        this.processEnter(e);\n        break;\n\n      case 'shiftUp':\n      case 'shiftDown':\n      case 'shiftLeft':\n      case 'shiftRight':\n      case 'upArrow':\n      case 'downArrow':\n      case 'leftArrow':\n      case 'rightArrow':\n        this.processSelection(e);\n        break;\n\n      case 'escape':\n        this.clearSelection();\n        break;\n\n      case 'ctrlShiftF':\n        this.toggleFieldList(e);\n        break;\n    }\n  };\n\n  KeyboardInteraction.prototype.getNextButton = function (target) {\n    var allPivotButtons = this.allpivotButtons(target);\n    removeClass(allPivotButtons, 'e-btn-focused');\n\n    if (this.parent.grid.element.querySelector('.' + cls.PIVOT_BUTTON_CLASS)) {\n      var len = allPivotButtons.length;\n\n      for (var i = 0; i < len; i++) {\n        if (allPivotButtons[i].getAttribute('data-uid') === target.getAttribute('data-uid')) {\n          return allPivotButtons[i + 1] ? allPivotButtons[i + 1] : target;\n        }\n      }\n    }\n\n    return target;\n  };\n\n  KeyboardInteraction.prototype.getPrevButton = function (target) {\n    var allPivotButtons = this.allpivotButtons(target);\n    removeClass(allPivotButtons, 'e-btn-focused');\n\n    if (this.parent.grid.element.querySelector('.' + cls.PIVOT_BUTTON_CLASS)) {\n      var len = allPivotButtons.length;\n\n      for (var i = 0; i < len; i++) {\n        if (allPivotButtons[i].getAttribute('data-uid') === target.getAttribute('data-uid')) {\n          return allPivotButtons[i - 1] ? allPivotButtons[i - 1] : target;\n        }\n      }\n    }\n\n    return target;\n  };\n\n  KeyboardInteraction.prototype.allpivotButtons = function (target) {\n    var buttons;\n    var columnFilterValueGroup = closest(target, '.' + cls.GRID_GROUPING_BAR_CLASS);\n    var rowGroup = closest(target, '.' + cls.GROUP_PIVOT_ROW);\n    var chartGroup = closest(target, '.' + cls.CHART_GROUPING_BAR_CLASS);\n    var tableAxis = target.classList.contains(cls.ROWSHEADER);\n    var chartAxis;\n    var rowAxis;\n    var columnFilterValueAxis;\n\n    if (columnFilterValueGroup !== null) {\n      rowAxis = columnFilterValueGroup.classList.contains(cls.GRID_GROUPING_BAR_CLASS);\n    } else if (rowGroup !== null) {\n      columnFilterValueAxis = rowGroup.classList.contains(cls.GROUP_PIVOT_ROW);\n    } else if (chartGroup !== null) {\n      chartAxis = chartGroup.classList.contains(cls.CHART_GROUPING_BAR_CLASS);\n    }\n\n    if (rowAxis || columnFilterValueAxis || tableAxis) {\n      /* eslint-disable */\n      var groupingbarButton = [].slice.call(this.parent.element.querySelector('.' + cls.GRID_GROUPING_BAR_CLASS).querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n      var headerButton = [].slice.call(this.parent.element.querySelector('.' + cls.GROUP_PIVOT_ROW).querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n      buttons = groupingbarButton.concat(headerButton);\n    } else if (chartAxis) {\n      buttons = [].slice.call(this.parent.element.querySelector('.' + cls.CHART_GROUPING_BAR_CLASS).querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n    }\n    /* eslint-enable */\n\n\n    return buttons;\n  };\n\n  KeyboardInteraction.prototype.processTab = function (e) {\n    var target = e.target;\n\n    if (target && (closest(target, '.' + cls.PIVOT_BUTTON_CLASS) || target.classList.contains('e-group-row'))) {\n      if (this.parent.grid) {\n        var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n\n        if (target.classList.contains('e-group-row') && target.querySelector('.e-btn-focused')) {\n          target = target.querySelector('.e-btn-focused');\n        } else if (target.classList.contains('e-group-row')) {\n          gridFocus.focus();\n          var element = gridFocus.getFocusedElement();\n          addClass([element], ['e-focused', 'e-focus']);\n          element.setAttribute('tabindex', '0');\n          e.preventDefault();\n          return;\n        }\n\n        var nextButton = this.getNextButton(target);\n\n        if (nextButton.getAttribute('data-uid') !== target.getAttribute('data-uid')) {\n          if (this.parent.element.querySelector('.e-focused')) {\n            this.parent.element.querySelector('.e-focused').setAttribute('tabindex', '-1');\n            removeClass(this.parent.element.querySelectorAll('.e-focus'), 'e-focus');\n            removeClass(this.parent.element.querySelectorAll('.e-focused'), 'e-focused');\n            gridFocus.setFocusedElement(this.parent.element.querySelector('.e-headercell'));\n            this.parent.element.querySelector('.e-headercell').setAttribute('tabindex', '0');\n          } else {\n            gridFocus.currentInfo.skipAction = true;\n          }\n\n          addClass([nextButton], 'e-btn-focused');\n          nextButton.focus();\n        } else {\n          gridFocus.focus();\n          var element = gridFocus.getFocusedElement();\n          addClass([element], ['e-focused', 'e-focus']);\n          element.setAttribute('tabindex', '0');\n        }\n\n        e.preventDefault();\n        return;\n      }\n    } else if (!this.parent.showGroupingBar && this.parent.showFieldList && target && closest(target, '.' + cls.TOGGLE_FIELD_LIST_CLASS)) {\n      if (this.parent.grid) {\n        var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n        gridFocus.focus();\n        var element = gridFocus.getFocusedElement();\n        addClass([element], ['e-focused', 'e-focus']);\n        element.setAttribute('tabindex', '0');\n        e.preventDefault();\n        return;\n      }\n    } else if (!this.parent.showGroupingBar && !this.parent.showFieldList && target && closest(target, '.' + cls.PIVOT_VIEW_CLASS) && !closest(target, '.e-popup.e-popup-open')) {\n      if (this.parent.grid) {\n        var gridElement = closest(target, '.' + cls.PIVOT_VIEW_CLASS);\n        var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n        var rows = [].slice.call(gridElement.getElementsByTagName('tr'));\n\n        if (target.innerHTML === rows[rows.length - 1].lastChild.innerHTML) {\n          gridFocus.currentInfo.skipAction = true;\n        } else {\n          gridFocus.focus();\n          var element = gridFocus.getFocusedElement();\n          addClass([element], ['e-focused', 'e-focus']);\n          element.setAttribute('tabindex', '0');\n          e.preventDefault();\n          return;\n        }\n      }\n    } else if (target && closest(target, '.' + cls.GRID_TOOLBAR) && this.parent.toolbar && this.parent.toolbarModule) {\n      clearTimeout(this.timeOutObj);\n      this.timeOutObj = setTimeout(function () {\n        removeClass(closest(target, '.' + cls.GRID_TOOLBAR).querySelectorAll('.e-menu-item.e-focused'), 'e-focused');\n\n        if (document.activeElement && document.activeElement.classList.contains('e-menu-item')) {\n          addClass([document.activeElement], 'e-focused');\n        }\n      });\n    } else if (target.classList.contains('e-numerictextbox')) {\n      var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n      gridFocus.focus();\n      var element = gridFocus.getFocusedElement();\n      removeClass([element], ['e-focused', 'e-focus']);\n      element.setAttribute('tabindex', '0');\n      e.preventDefault();\n    }\n  };\n\n  KeyboardInteraction.prototype.processShiftTab = function (e) {\n    var target = e.target;\n\n    if (target && (closest(target, '.' + cls.PIVOT_BUTTON_CLASS) || target.classList.contains('e-group-row'))) {\n      if (this.parent.grid) {\n        var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n\n        if (target.classList.contains('e-group-row') && target.querySelector('.e-btn-focused')) {\n          target = target.querySelector('.e-btn-focused');\n        } else if (target.classList.contains('e-group-row')) {\n          target = this.parent.element.querySelector('.e-btn-focused') ? this.parent.element.querySelector('.e-btn-focused') : this.parent.element.querySelector('.' + cls.GRID_GROUPING_BAR_CLASS);\n          var allPivotButtons = this.allpivotButtons(target);\n\n          if (allPivotButtons.length > 0 && allPivotButtons[allPivotButtons.length - 1]) {\n            gridFocus.currentInfo.skipAction = true;\n            allPivotButtons[allPivotButtons.length - 1].focus();\n            removeClass(allPivotButtons, 'e-btn-focused');\n            addClass([allPivotButtons[allPivotButtons.length - 1]], 'e-btn-focused');\n            e.preventDefault();\n            return;\n          }\n        }\n\n        var prevButton = this.getPrevButton(target);\n\n        if (prevButton.getAttribute('data-uid') !== target.getAttribute('data-uid')) {\n          gridFocus.currentInfo.skipAction = true;\n          prevButton.focus();\n          e.preventDefault();\n          return;\n        }\n      }\n    } else if (target && this.parent.grid && (target.classList.contains('e-movablefirst') || target.classList.contains('e-rowsheader') && closest(target, 'tr').getAttribute('data-uid') === this.parent.grid.element.querySelector('.e-frozencontent tr').getAttribute('data-uid'))) {\n      var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n\n      if (target.classList.contains('e-movablefirst')) {\n        target = this.parent.element.querySelector('.' + cls.GROUP_ROW_CLASS + ' .e-btn-focused') ? this.parent.element.querySelector('.' + cls.GROUP_ROW_CLASS + ' .e-btn-focused') : this.parent.element.querySelector('.' + cls.GROUP_ROW_CLASS);\n        var element = gridFocus.getFocusedElement();\n        removeClass([element], ['e-focused', 'e-focus']);\n      }\n\n      var allPivotButtons_1 = this.allpivotButtons(target);\n\n      if (allPivotButtons_1.length > 0) {\n        gridFocus.currentInfo.skipAction = true;\n        setTimeout(function () {\n          allPivotButtons_1[allPivotButtons_1.length - 1].focus();\n        });\n        removeClass(allPivotButtons_1, 'e-btn-focused');\n        addClass([allPivotButtons_1[allPivotButtons_1.length - 1]], 'e-btn-focused');\n        e.preventDefault();\n        return;\n      }\n    } else if (target && closest(target, '.' + cls.GRID_TOOLBAR) && this.parent.toolbar && this.parent.toolbarModule) {\n      clearTimeout(this.timeOutObj);\n      this.timeOutObj = setTimeout(function () {\n        removeClass(closest(target, '.' + cls.GRID_TOOLBAR).querySelectorAll('.e-menu-item.e-focused'), 'e-focused');\n\n        if (document.activeElement && document.activeElement.classList.contains('e-menu-item')) {\n          addClass([document.activeElement], 'e-focused');\n        }\n      });\n    } else if (target.classList.contains('e-numerictextbox')) {\n      var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n      gridFocus.focus();\n      var element = gridFocus.getFocusedElement();\n      removeClass([element], ['e-focused', 'e-focus']);\n      element.setAttribute('tabindex', '0');\n      e.preventDefault();\n    }\n  };\n\n  KeyboardInteraction.prototype.processEnter = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.' + cls.GRID_CLASS)) {\n      var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n\n      if (e.keyCode === 13 && !e.shiftKey && !e.ctrlKey) {\n        if (target.querySelector('.' + cls.ICON)) {\n          this.event = e;\n          target.querySelector('.' + cls.ICON).click();\n          gridFocus.focus();\n          var element = gridFocus.getFocusedElement();\n          addClass([element], ['e-focused', 'e-focus']);\n          element.setAttribute('tabindex', '0');\n        } else if (target.classList.contains('e-valuescontent')) {\n          target.dispatchEvent(new MouseEvent('dblclick', {\n            'view': window,\n            'bubbles': true,\n            'cancelable': true\n          }));\n\n          if (target.querySelector('.e-numerictextbox')) {\n            target.click();\n          }\n        } else if (target.classList.contains('e-numerictextbox')) {\n          gridFocus.focus();\n          var element = gridFocus.getFocusedElement();\n          removeClass([element], ['e-focused', 'e-focus']);\n        }\n      } else if (e.keyCode === 13 && e.shiftKey && !e.ctrlKey) {\n        if (this.parent.enableValueSorting) {\n          this.event = e;\n          target.click();\n          gridFocus.focus();\n          var element = gridFocus.getFocusedElement();\n          addClass([element], ['e-focused', 'e-focus']);\n          element.setAttribute('tabindex', '0');\n        }\n      } else if (e.keyCode === 13 && !e.shiftKey && e.ctrlKey) {\n        if (this.parent.hyperlinkSettings && target.querySelector('a')) {\n          target.querySelector('a').click();\n        }\n      }\n\n      e.preventDefault();\n      return;\n    }\n  };\n\n  KeyboardInteraction.prototype.clearSelection = function () {\n    var control = this.parent;\n    removeClass(control.element.querySelectorAll('.' + cls.CELL_SELECTED_BGCOLOR + ',.' + cls.SELECTED_BGCOLOR), [cls.SELECTED_BGCOLOR, cls.CELL_SELECTED_BGCOLOR, cls.CELL_ACTIVE_BGCOLOR]);\n    this.parent.renderModule.selected();\n  };\n\n  KeyboardInteraction.prototype.processSelection = function (e) {\n    var target = e.target;\n\n    if (this.parent.grid && this.parent.gridSettings.allowSelection && this.parent.gridSettings.selectionSettings.mode !== 'Row' && !target.classList.contains('e-numerictextbox')) {\n      var control_1 = this.parent;\n      var colIndex_1 = Number(e.target.getAttribute('aria-colIndex'));\n      var rowIndex_1 = Number(e.target.getAttribute('index'));\n      var ele_1;\n      /* eslint-disable */\n\n      if (target.nodeName === 'TH' || target.nodeName === 'TD') {\n        if (e.action === 'shiftUp' || e.action === 'upArrow') {\n          ele_1 = rowIndex_1 === 0 || colIndex_1 === 0 || target.nodeName !== 'TH' && control_1.renderModule.rowStartPos !== rowIndex_1 ? null : this.getParentElement(control_1, ele_1, colIndex_1, rowIndex_1 - 1);\n        } else if (e.action === 'shiftDown' || e.action === 'downArrow') {\n          ele_1 = control_1.element.querySelector('th[aria-colindex=\"' + colIndex_1 + '\"][index=\"' + (rowIndex_1 + 1) + '\"]');\n        } else if (e.action === 'shiftLeft' || e.action === 'leftArrow') {\n          ele_1 = e.target.previousSibling;\n        } else {\n          ele_1 = e.target.nextSibling;\n        }\n      }\n\n      if (!isNullOrUndefined(ele_1)) {\n        if (control_1.gridSettings.selectionSettings.mode === 'Both' ? !ele_1.classList.contains(cls.ROW_CELL_CLASS) : true) {\n          colIndex_1 = Number(ele_1.getAttribute('aria-colindex'));\n          rowIndex_1 = Number(ele_1.getAttribute('index'));\n          var colSpan_1 = Number(ele_1.getAttribute('aria-colspan'));\n          control_1.clearSelection(ele_1, e, colIndex_1, rowIndex_1);\n          var selectArgs = {\n            cancel: false,\n            isCellClick: true,\n            currentCell: ele_1,\n            data: control_1.pivotValues[rowIndex_1][colIndex_1]\n          };\n          control_1.trigger(events.cellSelecting, selectArgs, function (observedArgs) {\n            if (!observedArgs.cancel) {\n              control_1.applyColumnSelection(e, ele_1, colIndex_1, colIndex_1 + (colSpan_1 > 0 ? colSpan_1 - 1 : 0), rowIndex_1);\n            }\n          });\n        } else {\n          control_1.clearSelection(ele_1, e, colIndex_1, rowIndex_1);\n        }\n      } else {\n        if (e.action === 'upArrow') {\n          ele_1 = control_1.element.querySelector('[aria-colindex=\"' + colIndex_1 + '\"][index=\"' + (rowIndex_1 - 1) + '\"]');\n          rowIndex_1--;\n        } else if (e.action === 'downArrow') {\n          ele_1 = control_1.element.querySelector('[aria-colindex=\"' + colIndex_1 + '\"][index=\"' + (rowIndex_1 + 1) + '\"]');\n          rowIndex_1++;\n        }\n\n        if (!isNullOrUndefined(ele_1)) {\n          control_1.clearSelection(ele_1, e, colIndex_1, rowIndex_1);\n        }\n      }\n    } else if (target && (e.keyCode === 37 || e.keyCode === 38) && this.parent && this.parent.showGroupingBar && this.parent.groupingBarModule && !target.classList.contains('e-numerictextbox')) {\n      if (this.parent.grid && this.parent.element.querySelector('.e-frozenheader') && this.parent.element.querySelector('.e-frozenheader').querySelectorAll('.e-focus').length > 0) {\n        removeClass(this.parent.element.querySelector('.e-frozenheader').querySelectorAll('.e-focus'), 'e-focus');\n        removeClass(this.parent.element.querySelector('.e-frozenheader').querySelectorAll('.e-focused'), 'e-focused');\n        this.parent.element.querySelector('.e-headercell').setAttribute('tabindex', '-1');\n        var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n        gridFocus.setFocusedElement(target);\n        addClass([target], ['e-focused', 'e-focus']);\n        target.setAttribute('tabindex', '0');\n        target.focus();\n        e.preventDefault();\n        return;\n      }\n    } else if (target.classList.contains('e-numerictextbox') && e.action === 'rightArrow' || e.action === 'leftArrow') {\n      target.click();\n    }\n    /* eslint-enable */\n\n  };\n\n  KeyboardInteraction.prototype.getParentElement = function (control, ele, colIndex, rowIndex) {\n    while (!ele) {\n      ele = control.element.querySelector('[aria-colindex=\"' + colIndex + '\"][index=\"' + rowIndex + '\"]');\n      colIndex--;\n    }\n\n    return ele;\n  };\n\n  KeyboardInteraction.prototype.toggleFieldList = function (e) {\n    if (this.parent && !this.parent.isDestroyed && this.parent.showFieldList && this.parent.pivotFieldListModule && !this.parent.pivotFieldListModule.isDestroyed && this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS)) {\n      if (!this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS).classList.contains(cls.ICON_HIDDEN)) {\n        this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS).click();\n        e.preventDefault();\n        return;\n      } else if (this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS).classList.contains(cls.ICON_HIDDEN) && this.parent.pivotFieldListModule.dialogRenderer && this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog && !this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.isDestroyed) {\n        this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.hide();\n      }\n    }\n  };\n  /**\n   * To destroy the keyboard module.\n   * @returns  {void}\n   * @private\n   */\n\n\n  KeyboardInteraction.prototype.destroy = function () {\n    if (this.pivotViewKeyboardModule) {\n      this.pivotViewKeyboardModule.destroy();\n    } else {\n      return;\n    }\n  };\n\n  return KeyboardInteraction;\n}();\n\nexport { KeyboardInteraction };","map":{"version":3,"sources":["/workspace/Commb-olap-poc/commb-olap-js/node_modules/@syncfusion/ej2-pivotview/src/pivotview/actions/keyboard.js"],"names":["KeyboardEvents","closest","addClass","isNullOrUndefined","removeClass","cls","events","KeyboardInteraction","parent","keyConfigs","tab","shiftTab","enter","shiftUp","shiftDown","shiftLeft","shiftRight","shiftEnter","ctrlEnter","upArrow","downArrow","leftArrow","rightArrow","escape","ctrlShiftF","event","undefined","element","tabIndex","pivotViewKeyboardModule","keyAction","keyActionHandler","bind","eventName","prototype","e","action","processTab","processShiftTab","processEnter","processSelection","clearSelection","toggleFieldList","getNextButton","target","allPivotButtons","allpivotButtons","grid","querySelector","PIVOT_BUTTON_CLASS","len","length","i","getAttribute","getPrevButton","buttons","columnFilterValueGroup","GRID_GROUPING_BAR_CLASS","rowGroup","GROUP_PIVOT_ROW","chartGroup","CHART_GROUPING_BAR_CLASS","tableAxis","classList","contains","ROWSHEADER","chartAxis","rowAxis","columnFilterValueAxis","groupingbarButton","slice","call","querySelectorAll","headerButton","concat","gridFocus","serviceLocator","getService","focus","getFocusedElement","setAttribute","preventDefault","nextButton","setFocusedElement","currentInfo","skipAction","showGroupingBar","showFieldList","TOGGLE_FIELD_LIST_CLASS","PIVOT_VIEW_CLASS","gridElement","rows","getElementsByTagName","innerHTML","lastChild","GRID_TOOLBAR","toolbar","toolbarModule","clearTimeout","timeOutObj","setTimeout","document","activeElement","prevButton","GROUP_ROW_CLASS","allPivotButtons_1","GRID_CLASS","keyCode","shiftKey","ctrlKey","ICON","click","dispatchEvent","MouseEvent","window","enableValueSorting","hyperlinkSettings","control","CELL_SELECTED_BGCOLOR","SELECTED_BGCOLOR","CELL_ACTIVE_BGCOLOR","renderModule","selected","gridSettings","allowSelection","selectionSettings","mode","control_1","colIndex_1","Number","rowIndex_1","ele_1","nodeName","rowStartPos","getParentElement","previousSibling","nextSibling","ROW_CELL_CLASS","colSpan_1","selectArgs","cancel","isCellClick","currentCell","data","pivotValues","trigger","cellSelecting","observedArgs","applyColumnSelection","groupingBarModule","ele","colIndex","rowIndex","isDestroyed","pivotFieldListModule","ICON_HIDDEN","dialogRenderer","fieldListDialog","hide","destroy"],"mappings":"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","sourcesContent":["import { KeyboardEvents, closest, addClass, isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport * as cls from '../../common/base/css-constant';\nimport * as events from '../../common/base/constant';\n/**\n * PivotView Keyboard interaction\n */\n/** @hidden */\nvar KeyboardInteraction = /** @class */ (function () {\n    /**\n     * Constructor.\n     * @param {PivotView} parent - Instance of pivot table.\n     */\n    function KeyboardInteraction(parent) {\n        this.keyConfigs = {\n            tab: 'tab',\n            shiftTab: 'shift+tab',\n            enter: 'enter',\n            shiftUp: 'shift+upArrow',\n            shiftDown: 'shift+downArrow',\n            shiftLeft: 'shift+leftArrow',\n            shiftRight: 'shift+rightArrow',\n            shiftEnter: 'shift+enter',\n            ctrlEnter: 'ctrl+enter',\n            upArrow: 'upArrow',\n            downArrow: 'downArrow',\n            leftArrow: 'leftArrow',\n            rightArrow: 'rightArrow',\n            escape: 'escape',\n            ctrlShiftF: 'ctrl+shift+f'\n        };\n        this.parent = parent;\n        this.event = undefined;\n        this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n        this.pivotViewKeyboardModule = new KeyboardEvents(this.parent.element, {\n            keyAction: this.keyActionHandler.bind(this),\n            keyConfigs: this.keyConfigs,\n            eventName: 'keydown'\n        });\n    }\n    KeyboardInteraction.prototype.keyActionHandler = function (e) {\n        switch (e.action) {\n            case 'tab':\n                this.processTab(e);\n                break;\n            case 'shiftTab':\n                this.processShiftTab(e);\n                break;\n            case 'enter':\n            case 'shiftEnter':\n            case 'ctrlEnter':\n                this.processEnter(e);\n                break;\n            case 'shiftUp':\n            case 'shiftDown':\n            case 'shiftLeft':\n            case 'shiftRight':\n            case 'upArrow':\n            case 'downArrow':\n            case 'leftArrow':\n            case 'rightArrow':\n                this.processSelection(e);\n                break;\n            case 'escape':\n                this.clearSelection();\n                break;\n            case 'ctrlShiftF':\n                this.toggleFieldList(e);\n                break;\n        }\n    };\n    KeyboardInteraction.prototype.getNextButton = function (target) {\n        var allPivotButtons = this.allpivotButtons(target);\n        removeClass(allPivotButtons, 'e-btn-focused');\n        if (this.parent.grid.element.querySelector('.' + cls.PIVOT_BUTTON_CLASS)) {\n            var len = allPivotButtons.length;\n            for (var i = 0; i < len; i++) {\n                if (allPivotButtons[i].getAttribute('data-uid') === target.getAttribute('data-uid')) {\n                    return (allPivotButtons[i + 1] ? allPivotButtons[i + 1] : target);\n                }\n            }\n        }\n        return target;\n    };\n    KeyboardInteraction.prototype.getPrevButton = function (target) {\n        var allPivotButtons = this.allpivotButtons(target);\n        removeClass(allPivotButtons, 'e-btn-focused');\n        if (this.parent.grid.element.querySelector('.' + cls.PIVOT_BUTTON_CLASS)) {\n            var len = allPivotButtons.length;\n            for (var i = 0; i < len; i++) {\n                if (allPivotButtons[i].getAttribute('data-uid') === target.getAttribute('data-uid')) {\n                    return (allPivotButtons[i - 1] ? allPivotButtons[i - 1] : target);\n                }\n            }\n        }\n        return target;\n    };\n    KeyboardInteraction.prototype.allpivotButtons = function (target) {\n        var buttons;\n        var columnFilterValueGroup = closest(target, '.' + cls.GRID_GROUPING_BAR_CLASS);\n        var rowGroup = closest(target, '.' + cls.GROUP_PIVOT_ROW);\n        var chartGroup = closest(target, '.' + cls.CHART_GROUPING_BAR_CLASS);\n        var tableAxis = target.classList.contains(cls.ROWSHEADER);\n        var chartAxis;\n        var rowAxis;\n        var columnFilterValueAxis;\n        if (columnFilterValueGroup !== null) {\n            rowAxis = columnFilterValueGroup.classList.contains(cls.GRID_GROUPING_BAR_CLASS);\n        }\n        else if (rowGroup !== null) {\n            columnFilterValueAxis = rowGroup.classList.contains(cls.GROUP_PIVOT_ROW);\n        }\n        else if (chartGroup !== null) {\n            chartAxis = chartGroup.classList.contains(cls.CHART_GROUPING_BAR_CLASS);\n        }\n        if (rowAxis || columnFilterValueAxis || tableAxis) {\n            /* eslint-disable */\n            var groupingbarButton = [].slice.call(this.parent.element.querySelector('.' + cls.GRID_GROUPING_BAR_CLASS).querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n            var headerButton = [].slice.call(this.parent.element.querySelector('.' + cls.GROUP_PIVOT_ROW).querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n            buttons = groupingbarButton.concat(headerButton);\n        }\n        else if (chartAxis) {\n            buttons = [].slice.call(this.parent.element.querySelector('.' + cls.CHART_GROUPING_BAR_CLASS).querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n        }\n        /* eslint-enable */\n        return buttons;\n    };\n    KeyboardInteraction.prototype.processTab = function (e) {\n        var target = e.target;\n        if (target && (closest(target, '.' + cls.PIVOT_BUTTON_CLASS) || target.classList.contains('e-group-row'))) {\n            if (this.parent.grid) {\n                var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n                if (target.classList.contains('e-group-row') && target.querySelector('.e-btn-focused')) {\n                    target = target.querySelector('.e-btn-focused');\n                }\n                else if (target.classList.contains('e-group-row')) {\n                    gridFocus.focus();\n                    var element = gridFocus.getFocusedElement();\n                    addClass([element], ['e-focused', 'e-focus']);\n                    element.setAttribute('tabindex', '0');\n                    e.preventDefault();\n                    return;\n                }\n                var nextButton = this.getNextButton(target);\n                if (nextButton.getAttribute('data-uid') !== target.getAttribute('data-uid')) {\n                    if (this.parent.element.querySelector('.e-focused')) {\n                        this.parent.element.querySelector('.e-focused').setAttribute('tabindex', '-1');\n                        removeClass(this.parent.element.querySelectorAll('.e-focus'), 'e-focus');\n                        removeClass(this.parent.element.querySelectorAll('.e-focused'), 'e-focused');\n                        gridFocus.setFocusedElement(this.parent.element.querySelector('.e-headercell'));\n                        this.parent.element.querySelector('.e-headercell').setAttribute('tabindex', '0');\n                    }\n                    else {\n                        gridFocus.currentInfo.skipAction = true;\n                    }\n                    addClass([nextButton], 'e-btn-focused');\n                    nextButton.focus();\n                }\n                else {\n                    gridFocus.focus();\n                    var element = gridFocus.getFocusedElement();\n                    addClass([element], ['e-focused', 'e-focus']);\n                    element.setAttribute('tabindex', '0');\n                }\n                e.preventDefault();\n                return;\n            }\n        }\n        else if (!this.parent.showGroupingBar && this.parent.showFieldList &&\n            target && closest(target, '.' + cls.TOGGLE_FIELD_LIST_CLASS)) {\n            if (this.parent.grid) {\n                var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n                gridFocus.focus();\n                var element = gridFocus.getFocusedElement();\n                addClass([element], ['e-focused', 'e-focus']);\n                element.setAttribute('tabindex', '0');\n                e.preventDefault();\n                return;\n            }\n        }\n        else if (!this.parent.showGroupingBar && !this.parent.showFieldList &&\n            target && closest(target, '.' + cls.PIVOT_VIEW_CLASS) && !closest(target, '.e-popup.e-popup-open')) {\n            if (this.parent.grid) {\n                var gridElement = closest(target, '.' + cls.PIVOT_VIEW_CLASS);\n                var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n                var rows = [].slice.call(gridElement.getElementsByTagName('tr'));\n                if (target.innerHTML === (rows[rows.length - 1]).lastChild.innerHTML) {\n                    gridFocus.currentInfo.skipAction = true;\n                }\n                else {\n                    gridFocus.focus();\n                    var element = gridFocus.getFocusedElement();\n                    addClass([element], ['e-focused', 'e-focus']);\n                    element.setAttribute('tabindex', '0');\n                    e.preventDefault();\n                    return;\n                }\n            }\n        }\n        else if (target && closest(target, '.' + cls.GRID_TOOLBAR) && this.parent.toolbar && this.parent.toolbarModule) {\n            clearTimeout(this.timeOutObj);\n            this.timeOutObj = setTimeout(function () {\n                removeClass(closest(target, '.' + cls.GRID_TOOLBAR).querySelectorAll('.e-menu-item.e-focused'), 'e-focused');\n                if (document.activeElement && document.activeElement.classList.contains('e-menu-item')) {\n                    addClass([document.activeElement], 'e-focused');\n                }\n            });\n        }\n        else if (target.classList.contains('e-numerictextbox')) {\n            var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n            gridFocus.focus();\n            var element = gridFocus.getFocusedElement();\n            removeClass([element], ['e-focused', 'e-focus']);\n            element.setAttribute('tabindex', '0');\n            e.preventDefault();\n        }\n    };\n    KeyboardInteraction.prototype.processShiftTab = function (e) {\n        var target = e.target;\n        if (target && (closest(target, '.' + cls.PIVOT_BUTTON_CLASS) || target.classList.contains('e-group-row'))) {\n            if (this.parent.grid) {\n                var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n                if (target.classList.contains('e-group-row') && target.querySelector('.e-btn-focused')) {\n                    target = target.querySelector('.e-btn-focused');\n                }\n                else if (target.classList.contains('e-group-row')) {\n                    target = this.parent.element.querySelector('.e-btn-focused') ? this.parent.element.querySelector('.e-btn-focused') :\n                        this.parent.element.querySelector('.' + cls.GRID_GROUPING_BAR_CLASS);\n                    var allPivotButtons = this.allpivotButtons(target);\n                    if (allPivotButtons.length > 0 && allPivotButtons[allPivotButtons.length - 1]) {\n                        gridFocus.currentInfo.skipAction = true;\n                        allPivotButtons[allPivotButtons.length - 1].focus();\n                        removeClass(allPivotButtons, 'e-btn-focused');\n                        addClass([allPivotButtons[allPivotButtons.length - 1]], 'e-btn-focused');\n                        e.preventDefault();\n                        return;\n                    }\n                }\n                var prevButton = this.getPrevButton(target);\n                if (prevButton.getAttribute('data-uid') !== target.getAttribute('data-uid')) {\n                    gridFocus.currentInfo.skipAction = true;\n                    prevButton.focus();\n                    e.preventDefault();\n                    return;\n                }\n            }\n        }\n        else if (target && this.parent.grid && (target.classList.contains('e-movablefirst') ||\n            (target.classList.contains('e-rowsheader') && closest(target, 'tr').getAttribute('data-uid') ===\n                this.parent.grid.element.querySelector('.e-frozencontent tr').getAttribute('data-uid')))) {\n            var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n            if (target.classList.contains('e-movablefirst')) {\n                target = (this.parent.element.querySelector('.' + cls.GROUP_ROW_CLASS + ' .e-btn-focused')) ?\n                    (this.parent.element.querySelector('.' + cls.GROUP_ROW_CLASS + ' .e-btn-focused')) :\n                    (this.parent.element.querySelector('.' + cls.GROUP_ROW_CLASS));\n                var element = gridFocus.getFocusedElement();\n                removeClass([element], ['e-focused', 'e-focus']);\n            }\n            var allPivotButtons_1 = this.allpivotButtons(target);\n            if (allPivotButtons_1.length > 0) {\n                gridFocus.currentInfo.skipAction = true;\n                setTimeout(function () {\n                    allPivotButtons_1[allPivotButtons_1.length - 1].focus();\n                });\n                removeClass(allPivotButtons_1, 'e-btn-focused');\n                addClass([allPivotButtons_1[allPivotButtons_1.length - 1]], 'e-btn-focused');\n                e.preventDefault();\n                return;\n            }\n        }\n        else if (target && closest(target, '.' + cls.GRID_TOOLBAR) &&\n            this.parent.toolbar && this.parent.toolbarModule) {\n            clearTimeout(this.timeOutObj);\n            this.timeOutObj = setTimeout(function () {\n                removeClass(closest(target, '.' + cls.GRID_TOOLBAR).querySelectorAll('.e-menu-item.e-focused'), 'e-focused');\n                if (document.activeElement && document.activeElement.classList.contains('e-menu-item')) {\n                    addClass([document.activeElement], 'e-focused');\n                }\n            });\n        }\n        else if (target.classList.contains('e-numerictextbox')) {\n            var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n            gridFocus.focus();\n            var element = gridFocus.getFocusedElement();\n            removeClass([element], ['e-focused', 'e-focus']);\n            element.setAttribute('tabindex', '0');\n            e.preventDefault();\n        }\n    };\n    KeyboardInteraction.prototype.processEnter = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.' + cls.GRID_CLASS)) {\n            var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n            if (e.keyCode === 13 && !e.shiftKey && !e.ctrlKey) {\n                if (target.querySelector('.' + cls.ICON)) {\n                    this.event = e;\n                    target.querySelector('.' + cls.ICON).click();\n                    gridFocus.focus();\n                    var element = gridFocus.getFocusedElement();\n                    addClass([element], ['e-focused', 'e-focus']);\n                    element.setAttribute('tabindex', '0');\n                }\n                else if (target.classList.contains('e-valuescontent')) {\n                    target.dispatchEvent(new MouseEvent('dblclick', {\n                        'view': window,\n                        'bubbles': true,\n                        'cancelable': true\n                    }));\n                    if (target.querySelector('.e-numerictextbox')) {\n                        target.click();\n                    }\n                }\n                else if (target.classList.contains('e-numerictextbox')) {\n                    gridFocus.focus();\n                    var element = gridFocus.getFocusedElement();\n                    removeClass([element], ['e-focused', 'e-focus']);\n                }\n            }\n            else if (e.keyCode === 13 && e.shiftKey && !e.ctrlKey) {\n                if (this.parent.enableValueSorting) {\n                    this.event = e;\n                    target.click();\n                    gridFocus.focus();\n                    var element = gridFocus.getFocusedElement();\n                    addClass([element], ['e-focused', 'e-focus']);\n                    element.setAttribute('tabindex', '0');\n                }\n            }\n            else if (e.keyCode === 13 && !e.shiftKey && e.ctrlKey) {\n                if (this.parent.hyperlinkSettings && target.querySelector('a')) {\n                    target.querySelector('a').click();\n                }\n            }\n            e.preventDefault();\n            return;\n        }\n    };\n    KeyboardInteraction.prototype.clearSelection = function () {\n        var control = this.parent;\n        removeClass(control.element.querySelectorAll('.' + cls.CELL_SELECTED_BGCOLOR + ',.' + cls.SELECTED_BGCOLOR), [cls.SELECTED_BGCOLOR, cls.CELL_SELECTED_BGCOLOR, cls.CELL_ACTIVE_BGCOLOR]);\n        this.parent.renderModule.selected();\n    };\n    KeyboardInteraction.prototype.processSelection = function (e) {\n        var target = e.target;\n        if (this.parent.grid && this.parent.gridSettings.allowSelection && this.parent.gridSettings.selectionSettings.mode !== 'Row' &&\n            !target.classList.contains('e-numerictextbox')) {\n            var control_1 = this.parent;\n            var colIndex_1 = Number(e.target.getAttribute('aria-colIndex'));\n            var rowIndex_1 = Number(e.target.getAttribute('index'));\n            var ele_1;\n            /* eslint-disable */\n            if (target.nodeName === 'TH' || target.nodeName === 'TD') {\n                if (e.action === 'shiftUp' || e.action === 'upArrow') {\n                    ele_1 = (rowIndex_1 === 0 || colIndex_1 === 0 || (target.nodeName !== 'TH' &&\n                        control_1.renderModule.rowStartPos !== rowIndex_1)) ? null : this.getParentElement(control_1, ele_1, colIndex_1, rowIndex_1 - 1);\n                }\n                else if (e.action === 'shiftDown' || e.action === 'downArrow') {\n                    ele_1 = control_1.element.querySelector('th[aria-colindex=\"' + colIndex_1 + '\"][index=\"' + (rowIndex_1 + 1) + '\"]');\n                }\n                else if (e.action === 'shiftLeft' || e.action === 'leftArrow') {\n                    ele_1 = e.target.previousSibling;\n                }\n                else {\n                    ele_1 = e.target.nextSibling;\n                }\n            }\n            if (!isNullOrUndefined(ele_1)) {\n                if (control_1.gridSettings.selectionSettings.mode === 'Both' ? !ele_1.classList.contains(cls.ROW_CELL_CLASS) : true) {\n                    colIndex_1 = Number(ele_1.getAttribute('aria-colindex'));\n                    rowIndex_1 = Number(ele_1.getAttribute('index'));\n                    var colSpan_1 = Number(ele_1.getAttribute('aria-colspan'));\n                    control_1.clearSelection(ele_1, e, colIndex_1, rowIndex_1);\n                    var selectArgs = {\n                        cancel: false,\n                        isCellClick: true,\n                        currentCell: ele_1,\n                        data: control_1.pivotValues[rowIndex_1][colIndex_1]\n                    };\n                    control_1.trigger(events.cellSelecting, selectArgs, function (observedArgs) {\n                        if (!observedArgs.cancel) {\n                            control_1.applyColumnSelection(e, ele_1, colIndex_1, colIndex_1 + (colSpan_1 > 0 ? (colSpan_1 - 1) : 0), rowIndex_1);\n                        }\n                    });\n                }\n                else {\n                    control_1.clearSelection(ele_1, e, colIndex_1, rowIndex_1);\n                }\n            }\n            else {\n                if (e.action === 'upArrow') {\n                    ele_1 = control_1.element.querySelector('[aria-colindex=\"' + colIndex_1 + '\"][index=\"' + (rowIndex_1 - 1) + '\"]');\n                    rowIndex_1--;\n                }\n                else if (e.action === 'downArrow') {\n                    ele_1 = control_1.element.querySelector('[aria-colindex=\"' + colIndex_1 + '\"][index=\"' + (rowIndex_1 + 1) + '\"]');\n                    rowIndex_1++;\n                }\n                if (!isNullOrUndefined(ele_1)) {\n                    control_1.clearSelection(ele_1, e, colIndex_1, rowIndex_1);\n                }\n            }\n        }\n        else if (target && (e.keyCode === 37 || e.keyCode === 38) &&\n            this.parent && this.parent.showGroupingBar && this.parent.groupingBarModule && !target.classList.contains('e-numerictextbox')) {\n            if (this.parent.grid && this.parent.element.querySelector('.e-frozenheader') && this.parent.element.querySelector('.e-frozenheader').querySelectorAll('.e-focus').length > 0) {\n                removeClass(this.parent.element.querySelector('.e-frozenheader').querySelectorAll('.e-focus'), 'e-focus');\n                removeClass(this.parent.element.querySelector('.e-frozenheader').querySelectorAll('.e-focused'), 'e-focused');\n                this.parent.element.querySelector('.e-headercell').setAttribute('tabindex', '-1');\n                var gridFocus = this.parent.grid.serviceLocator.getService('focus');\n                gridFocus.setFocusedElement(target);\n                addClass([target], ['e-focused', 'e-focus']);\n                target.setAttribute('tabindex', '0');\n                target.focus();\n                e.preventDefault();\n                return;\n            }\n        }\n        else if (target.classList.contains('e-numerictextbox') && e.action === 'rightArrow' || e.action === 'leftArrow') {\n            target.click();\n        }\n        /* eslint-enable */\n    };\n    KeyboardInteraction.prototype.getParentElement = function (control, ele, colIndex, rowIndex) {\n        while (!ele) {\n            ele = control.element.querySelector('[aria-colindex=\"' + colIndex + '\"][index=\"' + rowIndex + '\"]');\n            colIndex--;\n        }\n        return ele;\n    };\n    KeyboardInteraction.prototype.toggleFieldList = function (e) {\n        if (this.parent && !this.parent.isDestroyed && this.parent.showFieldList &&\n            this.parent.pivotFieldListModule && !this.parent.pivotFieldListModule.isDestroyed &&\n            this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS)) {\n            if (!this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS).classList.contains(cls.ICON_HIDDEN)) {\n                this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS).click();\n                e.preventDefault();\n                return;\n            }\n            else if (this.parent.element.querySelector('.' + cls.TOGGLE_FIELD_LIST_CLASS).classList.contains(cls.ICON_HIDDEN) &&\n                this.parent.pivotFieldListModule.dialogRenderer && this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog &&\n                !this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.isDestroyed) {\n                this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.hide();\n            }\n        }\n    };\n    /**\n     * To destroy the keyboard module.\n     * @returns  {void}\n     * @private\n     */\n    KeyboardInteraction.prototype.destroy = function () {\n        if (this.pivotViewKeyboardModule) {\n            this.pivotViewKeyboardModule.destroy();\n        }\n        else {\n            return;\n        }\n    };\n    return KeyboardInteraction;\n}());\nexport { KeyboardInteraction };\n"]},"metadata":{},"sourceType":"module"}