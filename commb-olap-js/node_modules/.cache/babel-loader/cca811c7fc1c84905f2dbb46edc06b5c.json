{"ast":null,"code":"import { Dialog } from '@syncfusion/ej2-popups';\nimport { createElement, remove, extend, select } from '@syncfusion/ej2-base';\nimport * as cls from '../../common/base/css-constant';\nimport * as events from '../../common/base/constant';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { PivotUtil } from '../../base/util';\n/**\n * Module to render NumberFormatting Dialog\n */\n\nvar NumberFormatting = function () {\n  function NumberFormatting(parent) {\n    this.parent = parent;\n    this.parent.numberFormattingModule = this;\n    this.removeEventListener();\n    this.addEventListener();\n    this.newFormat = [];\n    this.lastFormattedValue = [];\n  }\n  /**\n   * To get module name.\n   * @returns {string} - string\n   */\n\n\n  NumberFormatting.prototype.getModuleName = function () {\n    return 'numberFormatting';\n  };\n  /**\n   * To show Number Formatting dialog.\n   * @returns {void}\n   */\n\n\n  NumberFormatting.prototype.showNumberFormattingDialog = function () {\n    var _this = this;\n\n    var valueDialog = createElement('div', {\n      id: this.parent.element.id + '_FormatDialog',\n      className: cls.FORMATTING_DIALOG\n    });\n    this.parent.element.appendChild(valueDialog);\n    this.dialog = new Dialog({\n      animationSettings: {\n        effect: 'Fade'\n      },\n      allowDragging: true,\n      header: this.parent.localeObj.getConstant('numberFormat'),\n      content: this.getDialogContent(),\n      isModal: true,\n      visible: true,\n      showCloseIcon: true,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      width: 'auto',\n      height: 'auto',\n      position: {\n        X: 'center',\n        Y: 'center'\n      },\n      buttons: [{\n        click: this.updateFormatting.bind(this),\n        buttonModel: {\n          cssClass: cls.OK_BUTTON_CLASS,\n          content: this.parent.localeObj.getConstant('apply'),\n          isPrimary: true\n        }\n      }, {\n        click: function () {\n          _this.dialog.hide();\n        },\n        buttonModel: {\n          cssClass: cls.CANCEL_BUTTON_CLASS,\n          content: this.parent.localeObj.getConstant('cancel')\n        }\n      }],\n      closeOnEscape: true,\n      target: this.parent.element,\n      overlayClick: function () {\n        _this.removeDialog();\n      },\n      close: this.removeDialog.bind(this)\n    });\n    this.dialog.isStringTemplate = true;\n    this.dialog.appendTo(valueDialog);\n    this.dialog.element.querySelector('.' + cls.DIALOG_HEADER).innerHTML = this.parent.localeObj.getConstant('numberFormat');\n    var formatObject;\n    this.newFormat = [{\n      name: this.parent.localeObj.getConstant('AllValues'),\n      format: 'N0',\n      useGrouping: true,\n      type: undefined\n    }];\n    var format = [];\n\n    for (var i = 0; i < this.parent.dataSourceSettings.formatSettings.length; i++) {\n      formatObject = {\n        name: this.parent.dataSourceSettings.formatSettings[i].name,\n        format: this.parent.dataSourceSettings.formatSettings[i].format,\n        useGrouping: this.parent.dataSourceSettings.formatSettings[i].useGrouping,\n        type: this.parent.dataSourceSettings.formatSettings[i].type\n      };\n      this.newFormat.push(formatObject);\n    }\n\n    for (var i = 0; i < this.newFormat.length; i++) {\n      format.push(this.newFormat[i].name);\n    }\n\n    for (var j = 0; j < this.parent.dataSourceSettings.values.length; j++) {\n      if (format.indexOf(this.parent.dataSourceSettings.values[j].name) === -1) {\n        formatObject = {\n          name: this.parent.dataSourceSettings.values[j].name,\n          format: 'N0',\n          useGrouping: true\n        };\n        this.newFormat.push(formatObject);\n      }\n    }\n\n    this.renderControls();\n  };\n\n  NumberFormatting.prototype.getDialogContent = function () {\n    var outerElement = createElement('div', {\n      id: this.parent.element.id + '_FormatDialogOuter',\n      className: cls.FORMATTING_DIALOG_OUTER\n    });\n    var table = createElement('table', {\n      id: this.parent.element.id + '_FormatTable',\n      className: cls.FORMATTING_TABLE\n    });\n    var tRow = createElement('tr');\n    var tValue = createElement('td');\n    var valueLable = createElement('div', {\n      id: this.parent.element.id + '_FormatValueLable',\n      className: cls.FORMATTING_VALUE_LABLE,\n      innerHTML: this.parent.localeObj.getConstant('values')\n    });\n    var valueDrop = createElement('div', {\n      id: this.parent.element.id + '_FormatValueDrop'\n    });\n    tValue.appendChild(valueLable);\n    tValue.appendChild(valueDrop);\n    tRow.appendChild(tValue);\n    table.appendChild(tRow);\n    tRow = createElement('tr');\n    tValue = createElement('td');\n    var formatLable = createElement('div', {\n      id: this.parent.element.id + '_FormatLable',\n      className: cls.FORMATTING_FORMAT_LABLE,\n      innerHTML: this.parent.localeObj.getConstant('formatType')\n    });\n    var formatDrop = createElement('div', {\n      id: this.parent.element.id + '_FormatDrop'\n    });\n    tValue.appendChild(formatLable);\n    tValue.appendChild(formatDrop);\n    tRow.appendChild(tValue);\n    table.appendChild(tRow);\n    tRow = createElement('tr');\n    tValue = createElement('td');\n    var groupingLable = createElement('div', {\n      id: this.parent.element.id + '_GroupingLable',\n      className: cls.FORMATTING_GROUPING_LABLE,\n      innerHTML: this.parent.localeObj.getConstant('grouping')\n    });\n    var groupingDrop = createElement('div', {\n      id: this.parent.element.id + '_GroupingDrop'\n    });\n    tValue.appendChild(groupingLable);\n    tValue.appendChild(groupingDrop);\n    tRow.appendChild(tValue);\n    table.appendChild(tRow);\n    tRow = createElement('tr');\n    tValue = createElement('td');\n    var decimalLable = createElement('div', {\n      id: this.parent.element.id + '_DecimalLable',\n      className: cls.FORMATTING_DECIMAL_LABLE,\n      innerHTML: this.parent.localeObj.getConstant('decimalPlaces')\n    });\n    var decimalDrop = createElement('div', {\n      id: this.parent.element.id + '_DecimalDrop'\n    });\n    tValue.appendChild(decimalLable);\n    tValue.appendChild(decimalDrop);\n    tRow.appendChild(tValue);\n    table.appendChild(tRow);\n    tRow = createElement('tr');\n    tValue = createElement('td');\n    this.customLable = createElement('div', {\n      id: this.parent.element.id + '_CustomLable',\n      className: cls.FORMATTING_CUSTOM_LABLE,\n      innerHTML: this.parent.localeObj.getConstant('customFormatString')\n    });\n    this.customText = createElement('input', {\n      id: this.parent.element.id + '_CustomText',\n      attrs: {\n        'type': 'text',\n        'tabindex': '0'\n      },\n      className: cls.INPUT + ' ' + cls.FORMATTING_CUSTOM_TEXT\n    });\n    tValue.appendChild(this.customLable);\n    tValue.appendChild(this.customText);\n    tRow.appendChild(tValue);\n    table.appendChild(tRow);\n    tRow = createElement('tr');\n    table.appendChild(tRow);\n    outerElement.appendChild(table);\n    return outerElement;\n  };\n\n  NumberFormatting.prototype.renderControls = function () {\n    if (select('#' + this.parent.element.id + '_FormatValueDrop', this.dialog.element)) {\n      var valueFields = [];\n      /* eslint-disable-line */\n\n      valueFields.push({\n        index: 0,\n        name: this.parent.localeObj.getConstant('AllValues'),\n        field: this.parent.localeObj.getConstant('AllValues')\n      });\n\n      for (var i = 0; i < this.parent.dataSourceSettings.values.length; i++) {\n        valueFields.push({\n          index: i + 1,\n          name: this.parent.dataSourceSettings.values[i].caption || this.parent.dataSourceSettings.values[i].name,\n          field: this.parent.dataSourceSettings.values[i].name\n        });\n      }\n\n      this.valuesDropDown = new DropDownList({\n        dataSource: valueFields,\n        fields: {\n          text: 'name',\n          value: 'field'\n        },\n        enableRtl: this.parent.enableRtl,\n        locale: this.parent.locale,\n        index: 0,\n        cssClass: cls.FORMATTING_VALUE_DROP,\n        change: this.valueChange.bind(this),\n        width: '100%',\n        open: this.customUpdate.bind(this)\n      });\n      this.valuesDropDown.isStringTemplate = true;\n      this.valuesDropDown.appendTo('#' + this.parent.element.id + '_FormatValueDrop');\n    }\n\n    if (select('#' + this.parent.element.id + '_FormatDrop', this.dialog.element)) {\n      var fields = [{\n        index: 0,\n        name: this.parent.localeObj.getConstant('number')\n      }, {\n        index: 1,\n        name: this.parent.localeObj.getConstant('currency')\n      }, {\n        index: 2,\n        name: this.parent.localeObj.getConstant('percentage')\n      }, {\n        index: 3,\n        name: this.parent.localeObj.getConstant('Custom')\n      }];\n      this.formatDropDown = new DropDownList({\n        dataSource: fields,\n        fields: {\n          text: 'name',\n          value: 'name'\n        },\n        index: 0,\n        change: this.dropDownChange.bind(this),\n        enableRtl: this.parent.enableRtl,\n        locale: this.parent.locale,\n        cssClass: cls.FORMATTING_FORMAT_DROP,\n        width: '100%'\n      });\n      this.formatDropDown.isStringTemplate = true;\n      this.formatDropDown.appendTo('#' + this.parent.element.id + '_FormatDrop');\n    }\n\n    if (select('#' + this.parent.element.id + '_GroupingDrop', this.dialog.element)) {\n      var fields = [{\n        index: 0,\n        name: this.parent.localeObj.getConstant('true')\n      }, {\n        index: 1,\n        name: this.parent.localeObj.getConstant('false')\n      }];\n      this.groupingDropDown = new DropDownList({\n        dataSource: fields,\n        fields: {\n          text: 'name',\n          value: 'name'\n        },\n        enableRtl: this.parent.enableRtl,\n        locale: this.parent.locale,\n        index: 0,\n        cssClass: cls.FORMATTING_GROUPING_DROP,\n        width: '100%',\n        change: this.groupingChange.bind(this)\n      });\n      this.groupingDropDown.isStringTemplate = true;\n      this.groupingDropDown.appendTo('#' + this.parent.element.id + '_GroupingDrop');\n    }\n\n    if (select('#' + this.parent.element.id + '_DecimalDrop', this.dialog.element)) {\n      var fields = [{\n        index: 0,\n        name: 0\n      }, {\n        index: 1,\n        name: 1\n      }, {\n        index: 2,\n        name: 2\n      }, {\n        index: 3,\n        name: 3\n      }, {\n        index: 4,\n        name: 4\n      }, {\n        index: 5,\n        name: 5\n      }, {\n        index: 6,\n        name: 6\n      }, {\n        index: 7,\n        name: 7\n      }, {\n        index: 8,\n        name: 8\n      }, {\n        index: 9,\n        name: 9\n      }, {\n        index: 10,\n        name: 10\n      }];\n      this.decimalDropDown = new DropDownList({\n        dataSource: fields,\n        fields: {\n          text: 'name',\n          value: 'name'\n        },\n        enableRtl: this.parent.enableRtl,\n        locale: this.parent.locale,\n        index: 0,\n        cssClass: cls.FORMATTING_DECIMAL_DROP,\n        popupHeight: 150,\n        width: '100%',\n        change: this.decimalChange.bind(this)\n      });\n      this.decimalDropDown.isStringTemplate = true;\n      this.decimalDropDown.appendTo('#' + this.parent.element.id + '_DecimalDrop');\n    }\n\n    if (this.formatDropDown.value !== this.parent.localeObj.getConstant('Custom')) {\n      this.customText.disabled = true;\n    }\n\n    if (this.lastFormattedValue.length !== 0) {\n      this.valuesDropDown.value = this.lastFormattedValue[0].name;\n      var fString = this.lastFormattedValue[0].format;\n      var first = fString === '' ? '' : fString.split('')[0].toLowerCase();\n      var group = this.lastFormattedValue[0].useGrouping ? this.parent.localeObj.getConstant('true') : this.parent.localeObj.getConstant('false');\n      this.updateFormattingDialog(fString, first, group);\n    }\n  };\n\n  NumberFormatting.prototype.valueChange = function (args) {\n    var format = this.newFormat;\n    var isExist = false;\n\n    for (var i = 0; i < format.length; i++) {\n      if (format[i].name === args.value) {\n        var fString = format[i].format;\n        var first = fString === '' ? '' : fString.split('')[0].toLowerCase();\n        var group = format[i].useGrouping ? this.parent.localeObj.getConstant('true') : this.parent.localeObj.getConstant('false');\n        this.updateFormattingDialog(fString, first, group);\n        isExist = true;\n        break;\n      }\n    }\n\n    if (!isExist) {\n      this.formatDropDown.value = this.parent.localeObj.getConstant('number');\n      this.decimalDropDown.value = 0;\n      this.groupingDropDown.value = this.parent.localeObj.getConstant('true');\n    }\n  };\n\n  NumberFormatting.prototype.updateFormattingDialog = function (fString, first, group) {\n    if (fString.length === 2 && ['n', 'p', 'c'].indexOf(first) > -1) {\n      this.formatDropDown.value = first === 'n' ? this.parent.localeObj.getConstant('number') : first === 'p' ? this.parent.localeObj.getConstant('percentage') : first === 'c' ? this.parent.localeObj.getConstant('currency') : this.parent.localeObj.getConstant('number');\n      this.decimalDropDown.value = Number(fString.split('')[1]);\n      this.groupingDropDown.value = group;\n    } else {\n      this.formatDropDown.value = this.parent.localeObj.getConstant('Custom');\n      this.customText.value = fString;\n    }\n  };\n\n  NumberFormatting.prototype.customUpdate = function () {\n    if (this.formatDropDown.value === this.parent.localeObj.getConstant('Custom')) {\n      var index = this.getIndexValue();\n      this.newFormat[index].format = this.customText.value;\n    }\n  };\n\n  NumberFormatting.prototype.dropDownChange = function (args) {\n    var index = this.getIndexValue();\n\n    if (args.value === this.parent.localeObj.getConstant('Custom')) {\n      this.customText.disabled = false;\n      this.groupingDropDown.enabled = false;\n      this.decimalDropDown.enabled = false;\n      this.newFormat[index].format = this.customText.value;\n    } else {\n      var text = this.formattedText();\n      this.newFormat[index].format = text;\n      this.customText.disabled = true;\n      this.groupingDropDown.enabled = true;\n      this.decimalDropDown.enabled = true;\n      this.customText.value = '';\n    }\n  };\n\n  NumberFormatting.prototype.groupingChange = function () {\n    var index = this.getIndexValue();\n    this.newFormat[index].useGrouping = this.groupingDropDown.value === this.parent.localeObj.getConstant('true') ? true : false;\n  };\n\n  NumberFormatting.prototype.getIndexValue = function () {\n    var format = [];\n\n    for (var i = 0; i < this.newFormat.length; i++) {\n      format.push(this.newFormat[i].name);\n    }\n\n    var index = format.indexOf(this.valuesDropDown.value.toString());\n    return index;\n  };\n\n  NumberFormatting.prototype.decimalChange = function () {\n    var index = this.getIndexValue();\n    var text = this.formattedText();\n    this.newFormat[index].format = text;\n  };\n\n  NumberFormatting.prototype.formattedText = function () {\n    var text;\n\n    if (this.formatDropDown.value === this.parent.localeObj.getConstant('number') || this.formatDropDown.value === this.parent.localeObj.getConstant('percentage') || this.formatDropDown.value === this.parent.localeObj.getConstant('currency')) {\n      text = this.formatDropDown.value === this.parent.localeObj.getConstant('number') ? 'N' : this.formatDropDown.value === this.parent.localeObj.getConstant('currency') ? 'C' : 'P';\n      return text += this.decimalDropDown.value;\n    } else {\n      return text = this.customText.value;\n    }\n  };\n\n  NumberFormatting.prototype.removeDialog = function () {\n    if (this.dialog && !this.dialog.isDestroyed) {\n      this.dialog.destroy();\n    }\n\n    if (document.getElementById(this.parent.element.id + '_FormatDialog')) {\n      remove(document.getElementById(this.parent.element.id + '_FormatDialog'));\n    }\n  };\n\n  NumberFormatting.prototype.updateFormatting = function () {\n    var _this = this;\n\n    var text = this.formattedText();\n    var index = this.getIndexValue();\n    this.newFormat.splice(index, 1);\n    var format = extend([], this.newFormat, true);\n    var formatSettings = this.parent.dataSourceSettings.formatSettings;\n\n    for (var i = 0; i < formatSettings.length; i++) {\n      this.insertFormat(formatSettings[i].name, formatSettings[i].format, formatSettings[i].type);\n    }\n\n    if (this.valuesDropDown.value === this.parent.localeObj.getConstant('AllValues')) {\n      for (var i = 0; i < this.parent.dataSourceSettings.values.length; i++) {\n        this.insertFormat(this.parent.dataSourceSettings.values[i].name, text);\n      }\n    } else {\n      this.insertFormat(this.valuesDropDown.value.toString(), text);\n    }\n\n    var eventArgs = {\n      formatSettings: PivotUtil.cloneFormatSettings(this.newFormat),\n      formatName: this.valuesDropDown.value.toString(),\n      cancel: false\n    };\n    this.parent.trigger(events.numberFormatting, eventArgs, function (observedArgs) {\n      if (!observedArgs.cancel) {\n        _this.parent.setProperties({\n          dataSourceSettings: {\n            formatSettings: observedArgs.formatSettings\n          }\n        }, true);\n\n        try {\n          _this.parent.updateDataSource(false);\n\n          _this.dialog.close();\n        } catch (exception) {\n          _this.parent.setProperties({\n            dataSourceSettings: {\n              formatSettings: format\n            }\n          }, true);\n\n          _this.parent.pivotCommon.errorDialog.createErrorDialog(_this.parent.localeObj.getConstant('error'), _this.parent.localeObj.getConstant('invalidFormat'), _this.dialog.element);\n\n          _this.parent.hideWaitingPopup();\n        }\n      } else {\n        _this.dialog.close();\n\n        _this.parent.setProperties({\n          dataSourceSettings: {\n            formatSettings: format\n          }\n        }, true);\n      }\n    });\n  };\n\n  NumberFormatting.prototype.insertFormat = function (fieldName, text, formatType) {\n    var isExist = false;\n    var newFormat = {\n      name: fieldName,\n      format: text,\n      useGrouping: this.groupingDropDown.value === this.parent.localeObj.getConstant('true') ? true : false,\n      type: formatType\n    };\n    var format = this.newFormat;\n\n    for (var i = 0; i < format.length; i++) {\n      if (format[i].name === fieldName) {\n        format[i] = newFormat;\n        isExist = true;\n      }\n    }\n\n    if (!isExist) {\n      format.push(newFormat);\n    }\n\n    this.lastFormattedValue = [];\n    this.lastFormattedValue.push(newFormat);\n  };\n  /**\n   * To add event listener.\n   * @returns {void}\n   * @hidden\n   */\n\n\n  NumberFormatting.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.initFormatting, this.showNumberFormattingDialog, this);\n  };\n  /**\n   * To remove event listener.\n   * @returns {void}\n   * @hidden\n   */\n\n\n  NumberFormatting.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.initFormatting, this.showNumberFormattingDialog);\n  };\n  /**\n   * To destroy the calculated field dialog\n   * @returns {void}\n   * @hidden\n   */\n\n\n  NumberFormatting.prototype.destroy = function () {\n    if (this.dialog && !this.dialog.isDestroyed) {\n      this.dialog.destroy();\n    }\n\n    this.removeEventListener();\n  };\n\n  return NumberFormatting;\n}();\n\nexport { NumberFormatting };","map":{"version":3,"sources":["/workspace/Commb-olap-poc/commb-olap-js/node_modules/@syncfusion/ej2-pivotview/src/common/popups/formatting-dialog.js"],"names":["Dialog","createElement","remove","extend","select","cls","events","DropDownList","PivotUtil","NumberFormatting","parent","numberFormattingModule","removeEventListener","addEventListener","newFormat","lastFormattedValue","prototype","getModuleName","showNumberFormattingDialog","_this","valueDialog","id","element","className","FORMATTING_DIALOG","appendChild","dialog","animationSettings","effect","allowDragging","header","localeObj","getConstant","content","getDialogContent","isModal","visible","showCloseIcon","enableRtl","locale","width","height","position","X","Y","buttons","click","updateFormatting","bind","buttonModel","cssClass","OK_BUTTON_CLASS","isPrimary","hide","CANCEL_BUTTON_CLASS","closeOnEscape","target","overlayClick","removeDialog","close","isStringTemplate","appendTo","querySelector","DIALOG_HEADER","innerHTML","formatObject","name","format","useGrouping","type","undefined","i","dataSourceSettings","formatSettings","length","push","j","values","indexOf","renderControls","outerElement","FORMATTING_DIALOG_OUTER","table","FORMATTING_TABLE","tRow","tValue","valueLable","FORMATTING_VALUE_LABLE","valueDrop","formatLable","FORMATTING_FORMAT_LABLE","formatDrop","groupingLable","FORMATTING_GROUPING_LABLE","groupingDrop","decimalLable","FORMATTING_DECIMAL_LABLE","decimalDrop","customLable","FORMATTING_CUSTOM_LABLE","customText","attrs","INPUT","FORMATTING_CUSTOM_TEXT","valueFields","index","field","caption","valuesDropDown","dataSource","fields","text","value","FORMATTING_VALUE_DROP","change","valueChange","open","customUpdate","formatDropDown","dropDownChange","FORMATTING_FORMAT_DROP","groupingDropDown","FORMATTING_GROUPING_DROP","groupingChange","decimalDropDown","FORMATTING_DECIMAL_DROP","popupHeight","decimalChange","disabled","fString","first","split","toLowerCase","group","updateFormattingDialog","args","isExist","Number","getIndexValue","enabled","formattedText","toString","isDestroyed","destroy","document","getElementById","splice","insertFormat","eventArgs","cloneFormatSettings","formatName","cancel","trigger","numberFormatting","observedArgs","setProperties","updateDataSource","exception","pivotCommon","errorDialog","createErrorDialog","hideWaitingPopup","fieldName","formatType","on","initFormatting","off"],"mappings":"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","sourcesContent":["import { Dialog } from '@syncfusion/ej2-popups';\nimport { createElement, remove, extend, select } from '@syncfusion/ej2-base';\nimport * as cls from '../../common/base/css-constant';\nimport * as events from '../../common/base/constant';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { PivotUtil } from '../../base/util';\n/**\n * Module to render NumberFormatting Dialog\n */\nvar NumberFormatting = /** @class */ (function () {\n    function NumberFormatting(parent) {\n        this.parent = parent;\n        this.parent.numberFormattingModule = this;\n        this.removeEventListener();\n        this.addEventListener();\n        this.newFormat = [];\n        this.lastFormattedValue = [];\n    }\n    /**\n     * To get module name.\n     * @returns {string} - string\n     */\n    NumberFormatting.prototype.getModuleName = function () {\n        return 'numberFormatting';\n    };\n    /**\n     * To show Number Formatting dialog.\n     * @returns {void}\n     */\n    NumberFormatting.prototype.showNumberFormattingDialog = function () {\n        var _this = this;\n        var valueDialog = createElement('div', {\n            id: this.parent.element.id + '_FormatDialog',\n            className: cls.FORMATTING_DIALOG\n        });\n        this.parent.element.appendChild(valueDialog);\n        this.dialog = new Dialog({\n            animationSettings: { effect: 'Fade' },\n            allowDragging: true,\n            header: this.parent.localeObj.getConstant('numberFormat'),\n            content: this.getDialogContent(),\n            isModal: true,\n            visible: true,\n            showCloseIcon: true,\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            width: 'auto',\n            height: 'auto',\n            position: { X: 'center', Y: 'center' },\n            buttons: [\n                {\n                    click: this.updateFormatting.bind(this),\n                    buttonModel: { cssClass: cls.OK_BUTTON_CLASS, content: this.parent.localeObj.getConstant('apply'), isPrimary: true }\n                },\n                {\n                    click: function () {\n                        _this.dialog.hide();\n                    },\n                    buttonModel: { cssClass: cls.CANCEL_BUTTON_CLASS, content: this.parent.localeObj.getConstant('cancel') }\n                }\n            ],\n            closeOnEscape: true,\n            target: this.parent.element,\n            overlayClick: function () {\n                _this.removeDialog();\n            },\n            close: this.removeDialog.bind(this)\n        });\n        this.dialog.isStringTemplate = true;\n        this.dialog.appendTo(valueDialog);\n        this.dialog.element.querySelector('.' + cls.DIALOG_HEADER).innerHTML = this.parent.localeObj.getConstant('numberFormat');\n        var formatObject;\n        this.newFormat = [{ name: this.parent.localeObj.getConstant('AllValues'), format: 'N0', useGrouping: true, type: undefined }];\n        var format = [];\n        for (var i = 0; i < this.parent.dataSourceSettings.formatSettings.length; i++) {\n            formatObject = {\n                name: this.parent.dataSourceSettings.formatSettings[i].name,\n                format: this.parent.dataSourceSettings.formatSettings[i].format,\n                useGrouping: this.parent.dataSourceSettings.formatSettings[i].useGrouping,\n                type: this.parent.dataSourceSettings.formatSettings[i].type\n            };\n            this.newFormat.push(formatObject);\n        }\n        for (var i = 0; i < this.newFormat.length; i++) {\n            format.push(this.newFormat[i].name);\n        }\n        for (var j = 0; j < this.parent.dataSourceSettings.values.length; j++) {\n            if (format.indexOf(this.parent.dataSourceSettings.values[j].name) === -1) {\n                formatObject = {\n                    name: this.parent.dataSourceSettings.values[j].name, format: 'N0',\n                    useGrouping: true\n                };\n                this.newFormat.push(formatObject);\n            }\n        }\n        this.renderControls();\n    };\n    NumberFormatting.prototype.getDialogContent = function () {\n        var outerElement = createElement('div', {\n            id: this.parent.element.id + '_FormatDialogOuter',\n            className: cls.FORMATTING_DIALOG_OUTER\n        });\n        var table = createElement('table', {\n            id: this.parent.element.id + '_FormatTable',\n            className: cls.FORMATTING_TABLE\n        });\n        var tRow = createElement('tr');\n        var tValue = createElement('td');\n        var valueLable = createElement('div', {\n            id: this.parent.element.id + '_FormatValueLable',\n            className: cls.FORMATTING_VALUE_LABLE,\n            innerHTML: this.parent.localeObj.getConstant('values')\n        });\n        var valueDrop = createElement('div', {\n            id: this.parent.element.id + '_FormatValueDrop'\n        });\n        tValue.appendChild(valueLable);\n        tValue.appendChild(valueDrop);\n        tRow.appendChild(tValue);\n        table.appendChild(tRow);\n        tRow = createElement('tr');\n        tValue = createElement('td');\n        var formatLable = createElement('div', {\n            id: this.parent.element.id + '_FormatLable',\n            className: cls.FORMATTING_FORMAT_LABLE,\n            innerHTML: this.parent.localeObj.getConstant('formatType')\n        });\n        var formatDrop = createElement('div', {\n            id: this.parent.element.id + '_FormatDrop'\n        });\n        tValue.appendChild(formatLable);\n        tValue.appendChild(formatDrop);\n        tRow.appendChild(tValue);\n        table.appendChild(tRow);\n        tRow = createElement('tr');\n        tValue = createElement('td');\n        var groupingLable = createElement('div', {\n            id: this.parent.element.id + '_GroupingLable',\n            className: cls.FORMATTING_GROUPING_LABLE,\n            innerHTML: this.parent.localeObj.getConstant('grouping')\n        });\n        var groupingDrop = createElement('div', {\n            id: this.parent.element.id + '_GroupingDrop'\n        });\n        tValue.appendChild(groupingLable);\n        tValue.appendChild(groupingDrop);\n        tRow.appendChild(tValue);\n        table.appendChild(tRow);\n        tRow = createElement('tr');\n        tValue = createElement('td');\n        var decimalLable = createElement('div', {\n            id: this.parent.element.id + '_DecimalLable',\n            className: cls.FORMATTING_DECIMAL_LABLE,\n            innerHTML: this.parent.localeObj.getConstant('decimalPlaces')\n        });\n        var decimalDrop = createElement('div', {\n            id: this.parent.element.id + '_DecimalDrop'\n        });\n        tValue.appendChild(decimalLable);\n        tValue.appendChild(decimalDrop);\n        tRow.appendChild(tValue);\n        table.appendChild(tRow);\n        tRow = createElement('tr');\n        tValue = createElement('td');\n        this.customLable = createElement('div', {\n            id: this.parent.element.id + '_CustomLable',\n            className: cls.FORMATTING_CUSTOM_LABLE,\n            innerHTML: this.parent.localeObj.getConstant('customFormatString')\n        });\n        this.customText = createElement('input', {\n            id: this.parent.element.id + '_CustomText',\n            attrs: {\n                'type': 'text', 'tabindex': '0'\n            },\n            className: cls.INPUT + ' ' + cls.FORMATTING_CUSTOM_TEXT\n        });\n        tValue.appendChild(this.customLable);\n        tValue.appendChild(this.customText);\n        tRow.appendChild(tValue);\n        table.appendChild(tRow);\n        tRow = createElement('tr');\n        table.appendChild(tRow);\n        outerElement.appendChild(table);\n        return outerElement;\n    };\n    NumberFormatting.prototype.renderControls = function () {\n        if (select('#' + this.parent.element.id + '_FormatValueDrop', this.dialog.element)) {\n            var valueFields = []; /* eslint-disable-line */\n            valueFields.push({\n                index: 0, name: this.parent.localeObj.getConstant('AllValues'), field: this.parent.localeObj.getConstant('AllValues')\n            });\n            for (var i = 0; i < this.parent.dataSourceSettings.values.length; i++) {\n                valueFields.push({\n                    index: i + 1, name: this.parent.dataSourceSettings.values[i].caption || this.parent.dataSourceSettings.values[i].name,\n                    field: this.parent.dataSourceSettings.values[i].name\n                });\n            }\n            this.valuesDropDown = new DropDownList({\n                dataSource: valueFields, fields: { text: 'name', value: 'field' }, enableRtl: this.parent.enableRtl, locale: this.parent.locale,\n                index: 0, cssClass: cls.FORMATTING_VALUE_DROP, change: this.valueChange.bind(this), width: '100%',\n                open: this.customUpdate.bind(this)\n            });\n            this.valuesDropDown.isStringTemplate = true;\n            this.valuesDropDown.appendTo('#' + this.parent.element.id + '_FormatValueDrop');\n        }\n        if (select('#' + this.parent.element.id + '_FormatDrop', this.dialog.element)) {\n            var fields = [\n                { index: 0, name: this.parent.localeObj.getConstant('number') },\n                { index: 1, name: this.parent.localeObj.getConstant('currency') },\n                { index: 2, name: this.parent.localeObj.getConstant('percentage') },\n                { index: 3, name: this.parent.localeObj.getConstant('Custom') }\n            ];\n            this.formatDropDown = new DropDownList({\n                dataSource: fields, fields: { text: 'name', value: 'name' },\n                index: 0, change: this.dropDownChange.bind(this), enableRtl: this.parent.enableRtl, locale: this.parent.locale,\n                cssClass: cls.FORMATTING_FORMAT_DROP, width: '100%'\n            });\n            this.formatDropDown.isStringTemplate = true;\n            this.formatDropDown.appendTo('#' + this.parent.element.id + '_FormatDrop');\n        }\n        if (select('#' + this.parent.element.id + '_GroupingDrop', this.dialog.element)) {\n            var fields = [\n                { index: 0, name: this.parent.localeObj.getConstant('true') },\n                { index: 1, name: this.parent.localeObj.getConstant('false') }\n            ];\n            this.groupingDropDown = new DropDownList({\n                dataSource: fields, fields: { text: 'name', value: 'name' }, enableRtl: this.parent.enableRtl, locale: this.parent.locale,\n                index: 0, cssClass: cls.FORMATTING_GROUPING_DROP, width: '100%', change: this.groupingChange.bind(this)\n            });\n            this.groupingDropDown.isStringTemplate = true;\n            this.groupingDropDown.appendTo('#' + this.parent.element.id + '_GroupingDrop');\n        }\n        if (select('#' + this.parent.element.id + '_DecimalDrop', this.dialog.element)) {\n            var fields = [\n                { index: 0, name: 0 },\n                { index: 1, name: 1 },\n                { index: 2, name: 2 },\n                { index: 3, name: 3 },\n                { index: 4, name: 4 },\n                { index: 5, name: 5 },\n                { index: 6, name: 6 },\n                { index: 7, name: 7 },\n                { index: 8, name: 8 },\n                { index: 9, name: 9 },\n                { index: 10, name: 10 }\n            ];\n            this.decimalDropDown = new DropDownList({\n                dataSource: fields, fields: { text: 'name', value: 'name' }, enableRtl: this.parent.enableRtl, locale: this.parent.locale,\n                index: 0, cssClass: cls.FORMATTING_DECIMAL_DROP, popupHeight: 150, width: '100%', change: this.decimalChange.bind(this)\n            });\n            this.decimalDropDown.isStringTemplate = true;\n            this.decimalDropDown.appendTo('#' + this.parent.element.id + '_DecimalDrop');\n        }\n        if (this.formatDropDown.value !== this.parent.localeObj.getConstant('Custom')) {\n            this.customText.disabled = true;\n        }\n        if (this.lastFormattedValue.length !== 0) {\n            this.valuesDropDown.value = this.lastFormattedValue[0].name;\n            var fString = this.lastFormattedValue[0].format;\n            var first = fString === '' ? '' : fString.split('')[0].toLowerCase();\n            var group = this.lastFormattedValue[0].useGrouping ? this.parent.localeObj.getConstant('true') :\n                this.parent.localeObj.getConstant('false');\n            this.updateFormattingDialog(fString, first, group);\n        }\n    };\n    NumberFormatting.prototype.valueChange = function (args) {\n        var format = this.newFormat;\n        var isExist = false;\n        for (var i = 0; i < format.length; i++) {\n            if (format[i].name === args.value) {\n                var fString = format[i].format;\n                var first = fString === '' ? '' : fString.split('')[0].toLowerCase();\n                var group = format[i].useGrouping ? this.parent.localeObj.getConstant('true') :\n                    this.parent.localeObj.getConstant('false');\n                this.updateFormattingDialog(fString, first, group);\n                isExist = true;\n                break;\n            }\n        }\n        if (!isExist) {\n            this.formatDropDown.value = this.parent.localeObj.getConstant('number');\n            this.decimalDropDown.value = 0;\n            this.groupingDropDown.value = this.parent.localeObj.getConstant('true');\n        }\n    };\n    NumberFormatting.prototype.updateFormattingDialog = function (fString, first, group) {\n        if (fString.length === 2 && ['n', 'p', 'c'].indexOf(first) > -1) {\n            this.formatDropDown.value = first === 'n' ? this.parent.localeObj.getConstant('number') : first === 'p' ?\n                this.parent.localeObj.getConstant('percentage') : first === 'c' ? this.parent.localeObj.getConstant('currency') :\n                this.parent.localeObj.getConstant('number');\n            this.decimalDropDown.value = Number(fString.split('')[1]);\n            this.groupingDropDown.value = group;\n        }\n        else {\n            this.formatDropDown.value = this.parent.localeObj.getConstant('Custom');\n            this.customText.value = fString;\n        }\n    };\n    NumberFormatting.prototype.customUpdate = function () {\n        if (this.formatDropDown.value === this.parent.localeObj.getConstant('Custom')) {\n            var index = this.getIndexValue();\n            this.newFormat[index].format = this.customText.value;\n        }\n    };\n    NumberFormatting.prototype.dropDownChange = function (args) {\n        var index = this.getIndexValue();\n        if (args.value === this.parent.localeObj.getConstant('Custom')) {\n            this.customText.disabled = false;\n            this.groupingDropDown.enabled = false;\n            this.decimalDropDown.enabled = false;\n            this.newFormat[index].format = this.customText.value;\n        }\n        else {\n            var text = this.formattedText();\n            this.newFormat[index].format = text;\n            this.customText.disabled = true;\n            this.groupingDropDown.enabled = true;\n            this.decimalDropDown.enabled = true;\n            this.customText.value = '';\n        }\n    };\n    NumberFormatting.prototype.groupingChange = function () {\n        var index = this.getIndexValue();\n        this.newFormat[index].useGrouping = this.groupingDropDown.value === this.parent.localeObj.getConstant('true') ? true : false;\n    };\n    NumberFormatting.prototype.getIndexValue = function () {\n        var format = [];\n        for (var i = 0; i < this.newFormat.length; i++) {\n            format.push(this.newFormat[i].name);\n        }\n        var index = format.indexOf(this.valuesDropDown.value.toString());\n        return index;\n    };\n    NumberFormatting.prototype.decimalChange = function () {\n        var index = this.getIndexValue();\n        var text = this.formattedText();\n        this.newFormat[index].format = text;\n    };\n    NumberFormatting.prototype.formattedText = function () {\n        var text;\n        if (this.formatDropDown.value === this.parent.localeObj.getConstant('number') ||\n            this.formatDropDown.value === this.parent.localeObj.getConstant('percentage') ||\n            this.formatDropDown.value === this.parent.localeObj.getConstant('currency')) {\n            text = this.formatDropDown.value === this.parent.localeObj.getConstant('number') ? 'N' :\n                this.formatDropDown.value === this.parent.localeObj.getConstant('currency') ? 'C' : 'P';\n            return text += this.decimalDropDown.value;\n        }\n        else {\n            return text = this.customText.value;\n        }\n    };\n    NumberFormatting.prototype.removeDialog = function () {\n        if (this.dialog && !this.dialog.isDestroyed) {\n            this.dialog.destroy();\n        }\n        if (document.getElementById(this.parent.element.id + '_FormatDialog')) {\n            remove(document.getElementById(this.parent.element.id + '_FormatDialog'));\n        }\n    };\n    NumberFormatting.prototype.updateFormatting = function () {\n        var _this = this;\n        var text = this.formattedText();\n        var index = this.getIndexValue();\n        this.newFormat.splice(index, 1);\n        var format = extend([], this.newFormat, true);\n        var formatSettings = this.parent.dataSourceSettings.formatSettings;\n        for (var i = 0; i < formatSettings.length; i++) {\n            this.insertFormat(formatSettings[i].name, formatSettings[i].format, formatSettings[i].type);\n        }\n        if (this.valuesDropDown.value === this.parent.localeObj.getConstant('AllValues')) {\n            for (var i = 0; i < this.parent.dataSourceSettings.values.length; i++) {\n                this.insertFormat(this.parent.dataSourceSettings.values[i].name, text);\n            }\n        }\n        else {\n            this.insertFormat(this.valuesDropDown.value.toString(), text);\n        }\n        var eventArgs = {\n            formatSettings: PivotUtil.cloneFormatSettings(this.newFormat),\n            formatName: this.valuesDropDown.value.toString(),\n            cancel: false\n        };\n        this.parent.trigger(events.numberFormatting, eventArgs, function (observedArgs) {\n            if (!observedArgs.cancel) {\n                _this.parent.setProperties({ dataSourceSettings: { formatSettings: observedArgs.formatSettings } }, true);\n                try {\n                    _this.parent.updateDataSource(false);\n                    _this.dialog.close();\n                }\n                catch (exception) {\n                    _this.parent.setProperties({ dataSourceSettings: { formatSettings: format } }, true);\n                    _this.parent.pivotCommon.errorDialog.createErrorDialog(_this.parent.localeObj.getConstant('error'), _this.parent.localeObj.getConstant('invalidFormat'), _this.dialog.element);\n                    _this.parent.hideWaitingPopup();\n                }\n            }\n            else {\n                _this.dialog.close();\n                _this.parent.setProperties({ dataSourceSettings: { formatSettings: format } }, true);\n            }\n        });\n    };\n    NumberFormatting.prototype.insertFormat = function (fieldName, text, formatType) {\n        var isExist = false;\n        var newFormat = {\n            name: fieldName, format: text,\n            useGrouping: this.groupingDropDown.value === this.parent.localeObj.getConstant('true') ? true : false,\n            type: formatType\n        };\n        var format = this.newFormat;\n        for (var i = 0; i < format.length; i++) {\n            if (format[i].name === fieldName) {\n                format[i] = newFormat;\n                isExist = true;\n            }\n        }\n        if (!isExist) {\n            format.push(newFormat);\n        }\n        this.lastFormattedValue = [];\n        this.lastFormattedValue.push(newFormat);\n    };\n    /**\n     * To add event listener.\n     * @returns {void}\n     * @hidden\n     */\n    NumberFormatting.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.initFormatting, this.showNumberFormattingDialog, this);\n    };\n    /**\n     * To remove event listener.\n     * @returns {void}\n     * @hidden\n     */\n    NumberFormatting.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.initFormatting, this.showNumberFormattingDialog);\n    };\n    /**\n     * To destroy the calculated field dialog\n     * @returns {void}\n     * @hidden\n     */\n    NumberFormatting.prototype.destroy = function () {\n        if (this.dialog && !this.dialog.isDestroyed) {\n            this.dialog.destroy();\n        }\n        this.removeEventListener();\n    };\n    return NumberFormatting;\n}());\nexport { NumberFormatting };\n"]},"metadata":{},"sourceType":"module"}