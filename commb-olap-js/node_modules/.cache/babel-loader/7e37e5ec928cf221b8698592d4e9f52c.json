{"ast":null,"code":"import { KeyboardEvents, closest, addClass, removeClass } from '@syncfusion/ej2-base';\nimport * as cls from '../base/css-constant';\n/**\n * Keyboard interaction\n */\n\n/** @hidden */\n\nvar CommonKeyboardInteraction = function () {\n  /**\n   * Constructor\n   */\n  function CommonKeyboardInteraction(parent) {\n    this.keyConfigs = {\n      shiftF: 'shift+F',\n      shiftS: 'shift+S',\n      shiftE: 'shift+E',\n      delete: 'delete',\n      enter: 'enter',\n      escape: 'escape',\n      upArrow: 'upArrow',\n      downArrow: 'downArrow'\n    };\n    /* eslint-enable */\n\n    this.parent = parent;\n    this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n    this.keyboardModule = new KeyboardEvents(this.parent.element, {\n      keyAction: this.keyActionHandler.bind(this),\n      keyConfigs: this.keyConfigs,\n      eventName: 'keydown'\n    });\n  }\n\n  CommonKeyboardInteraction.prototype.keyActionHandler = function (e) {\n    switch (e.action) {\n      case 'shiftF':\n        this.processFilter(e);\n        break;\n\n      case 'shiftS':\n        this.processSort(e);\n        break;\n\n      case 'shiftE':\n        this.processEdit(e);\n        break;\n\n      case 'delete':\n        this.processDelete(e);\n        break;\n\n      case 'enter':\n        this.processEnter(e);\n        break;\n\n      case 'escape':\n        this.processClose(e);\n        break;\n\n      case 'upArrow':\n      case 'downArrow':\n        this.processFilterNodeSelection(e);\n        break;\n    }\n  };\n\n  CommonKeyboardInteraction.prototype.getButtonElement = function (target) {\n    var allPivotButtons = [].slice.call(this.parent.element.querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n\n    for (var i = 0, len = allPivotButtons.length; i < len; i++) {\n      if (allPivotButtons[i].getAttribute('data-uid') === target.getAttribute('data-uid')) {\n        return allPivotButtons[i];\n      }\n    }\n\n    return target;\n  };\n\n  CommonKeyboardInteraction.prototype.processEnter = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS)) {\n      if (target.querySelector('.' + cls.AXISFIELD_ICON_CLASS) && closest(target, '.' + cls.VALUE_AXIS_CLASS)) {\n        target.querySelector('.' + cls.AXISFIELD_ICON_CLASS).click();\n      } else if (target.querySelector('.' + cls.CALC_EDIT)) {\n        target.querySelector('.' + cls.CALC_EDIT).click();\n      } else if (target.querySelector('.' + cls.SORT_CLASS) && !closest(target, '.' + cls.VALUE_AXIS_CLASS) && !closest(target, '.' + cls.AXIS_FILTER_CLASS)) {\n        target.querySelector('.' + cls.SORT_CLASS).click();\n        this.getButtonElement(target).focus();\n      } else if (target.querySelector('.' + cls.FILTER_COMMON_CLASS) && !closest(target, '.' + cls.VALUE_AXIS_CLASS)) {\n        target.querySelector('.' + cls.FILTER_COMMON_CLASS).click();\n      }\n\n      e.preventDefault();\n      return;\n    }\n  };\n\n  CommonKeyboardInteraction.prototype.processSort = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.SORT_CLASS) && !closest(target, '.' + cls.VALUE_AXIS_CLASS) && !closest(target, '.' + cls.AXIS_FILTER_CLASS)) {\n      target.querySelector('.' + cls.SORT_CLASS).click();\n      this.getButtonElement(target).focus();\n      e.preventDefault();\n      return;\n    }\n  };\n\n  CommonKeyboardInteraction.prototype.processEdit = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.CALC_EDIT)) {\n      target.querySelector('.' + cls.CALC_EDIT).click();\n      e.preventDefault();\n      return;\n    }\n  };\n\n  CommonKeyboardInteraction.prototype.processFilter = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.FILTER_COMMON_CLASS) && !closest(target, '.' + cls.VALUE_AXIS_CLASS)) {\n      target.querySelector('.' + cls.FILTER_COMMON_CLASS).click();\n\n      if (this.parent && this.parent.control && this.parent.moduleName === 'pivotview' && this.parent.control.grid && this.parent.control.showGroupingBar && this.parent.control.groupingBarModule && closest(target, '.' + cls.GROUP_ROW_CLASS) && this.parent.filterDialog && this.parent.filterDialog.dialogPopUp && !this.parent.filterDialog.dialogPopUp.isDestroyed && this.parent.filterDialog.dialogPopUp.element) {\n        var dialogElement_1 = this.parent.filterDialog.dialogPopUp.element;\n        var isExcelFilter_1 = this.parent.filterDialog.allowExcelLikeFilter;\n        clearTimeout(this.timeOutObj);\n        this.timeOutObj = setTimeout(function () {\n          if (dialogElement_1 && dialogElement_1.classList.contains('e-popup-open')) {\n            if (isExcelFilter_1 && dialogElement_1.querySelector('.e-dlg-closeicon-btn')) {\n              dialogElement_1.querySelector('.e-dlg-closeicon-btn').focus();\n            } else if (dialogElement_1.querySelector('input')) {\n              dialogElement_1.querySelector('input').focus();\n            }\n          }\n        });\n      }\n\n      e.preventDefault();\n      return;\n    }\n  };\n\n  CommonKeyboardInteraction.prototype.processFilterNodeSelection = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.' + cls.SELECT_ALL_CLASS) && e.keyCode === 40) {\n      var memberEditorTree = closest(target, '.' + cls.EDITOR_TREE_WRAPPER_CLASS).querySelector('.' + cls.EDITOR_TREE_CONTAINER_CLASS);\n\n      if (memberEditorTree && memberEditorTree.querySelector('li')) {\n        var firstLi = memberEditorTree.querySelector('li');\n\n        if (memberEditorTree.querySelector('li#_active')) {\n          removeClass([memberEditorTree.querySelector('li#_active')], ['e-hover', 'e-node-focus']);\n          memberEditorTree.querySelector('li#_active').removeAttribute('id');\n        }\n\n        firstLi.setAttribute('id', '_active');\n        addClass([firstLi], ['e-hover', 'e-node-focus']);\n        memberEditorTree.focus();\n        e.preventDefault();\n        return;\n      }\n    } else if (target && closest(target, '.' + cls.EDITOR_TREE_CONTAINER_CLASS) && e.keyCode === 38) {\n      var memberEditorTree = closest(target, '.' + cls.EDITOR_TREE_CONTAINER_CLASS);\n\n      if (memberEditorTree.querySelector('li#_active.e-hover.e-node-focus') && memberEditorTree.querySelector('li') && memberEditorTree.querySelector('li').classList.contains('e-prev-active-node') && memberEditorTree.querySelector('li') === memberEditorTree.querySelector('li#_active.e-hover.e-node-focus')) {\n        removeClass(memberEditorTree.querySelectorAll('li.e-prev-active-node'), 'e-prev-active-node');\n        var allMemberEditorTree = closest(target, '.' + cls.EDITOR_TREE_WRAPPER_CLASS).querySelector('.' + cls.SELECT_ALL_CLASS);\n\n        if (allMemberEditorTree && allMemberEditorTree.querySelector('li')) {\n          var firstLi = allMemberEditorTree.querySelector('li');\n          firstLi.setAttribute('id', '_active');\n          addClass([firstLi], ['e-hover', 'e-node-focus']);\n          allMemberEditorTree.focus();\n          e.preventDefault();\n          return;\n        }\n      }\n    } else if (target && target.id === this.parent.parentID + '_inputbox') {\n      if (e.action === 'upArrow') {\n        target.parentElement.querySelector('.e-spin-up').click();\n      } else if (e.action === 'downArrow') {\n        target.parentElement.querySelector('.e-spin-down').click();\n      }\n    }\n  };\n\n  CommonKeyboardInteraction.prototype.processDelete = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.REMOVE_CLASS)) {\n      target.querySelector('.' + cls.REMOVE_CLASS).click();\n      e.preventDefault();\n      return;\n    }\n  };\n\n  CommonKeyboardInteraction.prototype.processClose = function (e) {\n    var target = e.target;\n\n    if (target && closest(target, '.e-popup.e-popup-open')) {\n      /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n      var dialogInstance = closest(target, '.e-popup.e-popup-open').ej2_instances[0];\n\n      if (dialogInstance && !dialogInstance.closeOnEscape) {\n        var button = dialogInstance.element.getAttribute('data-fieldName');\n        dialogInstance.hide();\n\n        if (this.parent.element) {\n          var pivotButtons = [].slice.call(this.parent.element.querySelectorAll('.e-pivot-button'));\n\n          for (var _i = 0, pivotButtons_1 = pivotButtons; _i < pivotButtons_1.length; _i++) {\n            var item = pivotButtons_1[_i];\n\n            if (item.getAttribute('data-uid') === button) {\n              item.focus();\n              break;\n            }\n          }\n        }\n\n        e.preventDefault();\n        return;\n      }\n    }\n  };\n  /**\n   * To destroy the keyboard module.\n   * @returns {void}\n   * @private\n   */\n\n\n  CommonKeyboardInteraction.prototype.destroy = function () {\n    if (this.keyboardModule) {\n      this.keyboardModule.destroy();\n    } else {\n      return;\n    }\n  };\n\n  return CommonKeyboardInteraction;\n}();\n\nexport { CommonKeyboardInteraction };","map":{"version":3,"sources":["/workspace/Commb-olap-poc/commb-olap-js/node_modules/@syncfusion/ej2-pivotview/src/common/actions/keyboard.js"],"names":["KeyboardEvents","closest","addClass","removeClass","cls","CommonKeyboardInteraction","parent","keyConfigs","shiftF","shiftS","shiftE","delete","enter","escape","upArrow","downArrow","element","tabIndex","keyboardModule","keyAction","keyActionHandler","bind","eventName","prototype","e","action","processFilter","processSort","processEdit","processDelete","processEnter","processClose","processFilterNodeSelection","getButtonElement","target","allPivotButtons","slice","call","querySelectorAll","PIVOT_BUTTON_CLASS","i","len","length","getAttribute","querySelector","AXISFIELD_ICON_CLASS","VALUE_AXIS_CLASS","click","CALC_EDIT","SORT_CLASS","AXIS_FILTER_CLASS","focus","FILTER_COMMON_CLASS","preventDefault","control","moduleName","grid","showGroupingBar","groupingBarModule","GROUP_ROW_CLASS","filterDialog","dialogPopUp","isDestroyed","dialogElement_1","isExcelFilter_1","allowExcelLikeFilter","clearTimeout","timeOutObj","setTimeout","classList","contains","SELECT_ALL_CLASS","keyCode","memberEditorTree","EDITOR_TREE_WRAPPER_CLASS","EDITOR_TREE_CONTAINER_CLASS","firstLi","removeAttribute","setAttribute","allMemberEditorTree","id","parentID","parentElement","REMOVE_CLASS","dialogInstance","ej2_instances","closeOnEscape","button","hide","pivotButtons","_i","pivotButtons_1","item","destroy"],"mappings":"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","sourcesContent":["import { KeyboardEvents, closest, addClass, removeClass } from '@syncfusion/ej2-base';\nimport * as cls from '../base/css-constant';\n/**\n * Keyboard interaction\n */\n/** @hidden */\nvar CommonKeyboardInteraction = /** @class */ (function () {\n    /**\n     * Constructor\n     */\n    function CommonKeyboardInteraction(parent) {\n        this.keyConfigs = {\n            shiftF: 'shift+F',\n            shiftS: 'shift+S',\n            shiftE: 'shift+E',\n            delete: 'delete',\n            enter: 'enter',\n            escape: 'escape',\n            upArrow: 'upArrow',\n            downArrow: 'downArrow'\n        };\n        /* eslint-enable */\n        this.parent = parent;\n        this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n        this.keyboardModule = new KeyboardEvents(this.parent.element, {\n            keyAction: this.keyActionHandler.bind(this),\n            keyConfigs: this.keyConfigs,\n            eventName: 'keydown'\n        });\n    }\n    CommonKeyboardInteraction.prototype.keyActionHandler = function (e) {\n        switch (e.action) {\n            case 'shiftF':\n                this.processFilter(e);\n                break;\n            case 'shiftS':\n                this.processSort(e);\n                break;\n            case 'shiftE':\n                this.processEdit(e);\n                break;\n            case 'delete':\n                this.processDelete(e);\n                break;\n            case 'enter':\n                this.processEnter(e);\n                break;\n            case 'escape':\n                this.processClose(e);\n                break;\n            case 'upArrow':\n            case 'downArrow':\n                this.processFilterNodeSelection(e);\n                break;\n        }\n    };\n    CommonKeyboardInteraction.prototype.getButtonElement = function (target) {\n        var allPivotButtons = [].slice.call(this.parent.element.querySelectorAll('.' + cls.PIVOT_BUTTON_CLASS));\n        for (var i = 0, len = allPivotButtons.length; i < len; i++) {\n            if (allPivotButtons[i].getAttribute('data-uid') === target.getAttribute('data-uid')) {\n                return allPivotButtons[i];\n            }\n        }\n        return target;\n    };\n    CommonKeyboardInteraction.prototype.processEnter = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS)) {\n            if (target.querySelector('.' + cls.AXISFIELD_ICON_CLASS) && closest(target, '.' + cls.VALUE_AXIS_CLASS)) {\n                target.querySelector('.' + cls.AXISFIELD_ICON_CLASS).click();\n            }\n            else if (target.querySelector('.' + cls.CALC_EDIT)) {\n                target.querySelector('.' + cls.CALC_EDIT).click();\n            }\n            else if (target.querySelector('.' + cls.SORT_CLASS) &&\n                !closest(target, '.' + cls.VALUE_AXIS_CLASS) && !closest(target, '.' + cls.AXIS_FILTER_CLASS)) {\n                target.querySelector('.' + cls.SORT_CLASS).click();\n                this.getButtonElement(target).focus();\n            }\n            else if (target.querySelector('.' + cls.FILTER_COMMON_CLASS) && !closest(target, '.' + cls.VALUE_AXIS_CLASS)) {\n                target.querySelector('.' + cls.FILTER_COMMON_CLASS).click();\n            }\n            e.preventDefault();\n            return;\n        }\n    };\n    CommonKeyboardInteraction.prototype.processSort = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.SORT_CLASS) &&\n            !closest(target, '.' + cls.VALUE_AXIS_CLASS) && !closest(target, '.' + cls.AXIS_FILTER_CLASS)) {\n            target.querySelector('.' + cls.SORT_CLASS).click();\n            this.getButtonElement(target).focus();\n            e.preventDefault();\n            return;\n        }\n    };\n    CommonKeyboardInteraction.prototype.processEdit = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.CALC_EDIT)) {\n            target.querySelector('.' + cls.CALC_EDIT).click();\n            e.preventDefault();\n            return;\n        }\n    };\n    CommonKeyboardInteraction.prototype.processFilter = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.FILTER_COMMON_CLASS) &&\n            !closest(target, '.' + cls.VALUE_AXIS_CLASS)) {\n            target.querySelector('.' + cls.FILTER_COMMON_CLASS).click();\n            if (this.parent && this.parent.control && this.parent.moduleName === 'pivotview' &&\n                this.parent.control.grid && this.parent.control.showGroupingBar &&\n                this.parent.control.groupingBarModule && closest(target, '.' + cls.GROUP_ROW_CLASS) &&\n                this.parent.filterDialog && this.parent.filterDialog.dialogPopUp &&\n                !this.parent.filterDialog.dialogPopUp.isDestroyed && this.parent.filterDialog.dialogPopUp.element) {\n                var dialogElement_1 = this.parent.filterDialog.dialogPopUp.element;\n                var isExcelFilter_1 = this.parent.filterDialog.allowExcelLikeFilter;\n                clearTimeout(this.timeOutObj);\n                this.timeOutObj = setTimeout(function () {\n                    if (dialogElement_1 && dialogElement_1.classList.contains('e-popup-open')) {\n                        if (isExcelFilter_1 && dialogElement_1.querySelector('.e-dlg-closeicon-btn')) {\n                            dialogElement_1.querySelector('.e-dlg-closeicon-btn').focus();\n                        }\n                        else if (dialogElement_1.querySelector('input')) {\n                            dialogElement_1.querySelector('input').focus();\n                        }\n                    }\n                });\n            }\n            e.preventDefault();\n            return;\n        }\n    };\n    CommonKeyboardInteraction.prototype.processFilterNodeSelection = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.' + cls.SELECT_ALL_CLASS) && e.keyCode === 40) {\n            var memberEditorTree = closest(target, '.' + cls.EDITOR_TREE_WRAPPER_CLASS).querySelector('.' + cls.EDITOR_TREE_CONTAINER_CLASS);\n            if (memberEditorTree && memberEditorTree.querySelector('li')) {\n                var firstLi = memberEditorTree.querySelector('li');\n                if (memberEditorTree.querySelector('li#_active')) {\n                    removeClass([memberEditorTree.querySelector('li#_active')], ['e-hover', 'e-node-focus']);\n                    memberEditorTree.querySelector('li#_active').removeAttribute('id');\n                }\n                firstLi.setAttribute('id', '_active');\n                addClass([firstLi], ['e-hover', 'e-node-focus']);\n                memberEditorTree.focus();\n                e.preventDefault();\n                return;\n            }\n        }\n        else if (target && closest(target, '.' + cls.EDITOR_TREE_CONTAINER_CLASS) && e.keyCode === 38) {\n            var memberEditorTree = closest(target, '.' + cls.EDITOR_TREE_CONTAINER_CLASS);\n            if (memberEditorTree.querySelector('li#_active.e-hover.e-node-focus') && memberEditorTree.querySelector('li') &&\n                memberEditorTree.querySelector('li').classList.contains('e-prev-active-node') &&\n                memberEditorTree.querySelector('li') === memberEditorTree.querySelector('li#_active.e-hover.e-node-focus')) {\n                removeClass(memberEditorTree.querySelectorAll('li.e-prev-active-node'), 'e-prev-active-node');\n                var allMemberEditorTree = closest(target, '.' + cls.EDITOR_TREE_WRAPPER_CLASS).querySelector('.' + cls.SELECT_ALL_CLASS);\n                if (allMemberEditorTree && allMemberEditorTree.querySelector('li')) {\n                    var firstLi = allMemberEditorTree.querySelector('li');\n                    firstLi.setAttribute('id', '_active');\n                    addClass([firstLi], ['e-hover', 'e-node-focus']);\n                    allMemberEditorTree.focus();\n                    e.preventDefault();\n                    return;\n                }\n            }\n        }\n        else if (target && target.id === this.parent.parentID + '_inputbox') {\n            if (e.action === 'upArrow') {\n                target.parentElement.querySelector('.e-spin-up').click();\n            }\n            else if (e.action === 'downArrow') {\n                target.parentElement.querySelector('.e-spin-down').click();\n            }\n        }\n    };\n    CommonKeyboardInteraction.prototype.processDelete = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.' + cls.PIVOT_BUTTON_CLASS) && target.querySelector('.' + cls.REMOVE_CLASS)) {\n            target.querySelector('.' + cls.REMOVE_CLASS).click();\n            e.preventDefault();\n            return;\n        }\n    };\n    CommonKeyboardInteraction.prototype.processClose = function (e) {\n        var target = e.target;\n        if (target && closest(target, '.e-popup.e-popup-open')) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var dialogInstance = closest(target, '.e-popup.e-popup-open').ej2_instances[0];\n            if (dialogInstance && !dialogInstance.closeOnEscape) {\n                var button = dialogInstance.element.getAttribute('data-fieldName');\n                dialogInstance.hide();\n                if (this.parent.element) {\n                    var pivotButtons = [].slice.call(this.parent.element.querySelectorAll('.e-pivot-button'));\n                    for (var _i = 0, pivotButtons_1 = pivotButtons; _i < pivotButtons_1.length; _i++) {\n                        var item = pivotButtons_1[_i];\n                        if (item.getAttribute('data-uid') === button) {\n                            item.focus();\n                            break;\n                        }\n                    }\n                }\n                e.preventDefault();\n                return;\n            }\n        }\n    };\n    /**\n     * To destroy the keyboard module.\n     * @returns {void}\n     * @private\n     */\n    CommonKeyboardInteraction.prototype.destroy = function () {\n        if (this.keyboardModule) {\n            this.keyboardModule.destroy();\n        }\n        else {\n            return;\n        }\n    };\n    return CommonKeyboardInteraction;\n}());\nexport { CommonKeyboardInteraction };\n"]},"metadata":{},"sourceType":"module"}